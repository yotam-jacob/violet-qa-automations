{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@neuralegion/cypress-har-generator/webpack/bootstrap","webpack://@neuralegion/cypress-har-generator/webpack/runtime/compat get default export","webpack://@neuralegion/cypress-har-generator/webpack/runtime/define property getters","webpack://@neuralegion/cypress-har-generator/webpack/runtime/hasOwnProperty shorthand","webpack://@neuralegion/cypress-har-generator/webpack/runtime/make namespace object","webpack://@neuralegion/cypress-har-generator/external commonjs \"tslib\"","webpack://@neuralegion/cypress-har-generator/./src/network/EntryBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/ErrorUtils.ts","webpack://@neuralegion/cypress-har-generator/external node-commonjs \"os\"","webpack://@neuralegion/cypress-har-generator/external node-commonjs \"util\"","webpack://@neuralegion/cypress-har-generator/./src/network/DefaultHarExporter.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/Loader.ts","webpack://@neuralegion/cypress-har-generator/external node-commonjs \"path\"","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkCookie.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkRequest.ts","webpack://@neuralegion/cypress-har-generator/./src/network/CookieParser.ts","webpack://@neuralegion/cypress-har-generator/./src/utils/StringUtils.ts","webpack://@neuralegion/cypress-har-generator/./src/network/ExtraInfoBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkObserver.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/HostFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/PathFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/MimeFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/MinStatusCodeFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/BlobFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/StatusCodeFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/filters/CompositeFilter.ts","webpack://@neuralegion/cypress-har-generator/./src/network/HarBuilder.ts","webpack://@neuralegion/cypress-har-generator/./src/network/NetworkIdleMonitor.ts","webpack://@neuralegion/cypress-har-generator/./src/constants.ts","webpack://@neuralegion/cypress-har-generator/external commonjs \"chalk\"","webpack://@neuralegion/cypress-har-generator/./src/utils/Logger.ts","webpack://@neuralegion/cypress-har-generator/external node-commonjs \"fs\"","webpack://@neuralegion/cypress-har-generator/external node-commonjs \"crypto\"","webpack://@neuralegion/cypress-har-generator/./src/utils/FileManager.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/messages.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/DefaultNetwork.ts","webpack://@neuralegion/cypress-har-generator/external commonjs \"chrome-remote-interface\"","webpack://@neuralegion/cypress-har-generator/./src/cdp/CDPConnection.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/RetryStrategy.ts","webpack://@neuralegion/cypress-har-generator/./src/index.ts","webpack://@neuralegion/cypress-har-generator/./src/Plugin.ts","webpack://@neuralegion/cypress-har-generator/./src/cdp/DefaultConnectionFactory.ts","webpack://@neuralegion/cypress-har-generator/./src/network/DefaultObserverFactory.ts","webpack://@neuralegion/cypress-har-generator/./src/network/DefaultHarExporterFactory.ts"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"tslib\");","import { NetworkRequest } from './NetworkRequest';\nimport { NetworkCookie } from './NetworkCookie';\nimport type { ContentData } from './NetworkRequest';\nimport type {\n  Content,\n  Cookie,\n  Entry,\n  Param,\n  PostData,\n  Request,\n  Response,\n  Timings\n} from 'har-format';\n\nexport class EntryBuilder {\n  constructor(private readonly request: NetworkRequest) {}\n\n  public async build(): Promise<Entry> {\n    let serverIPAddress: string = this.request.remoteAddress;\n\n    const portPositionInString: number = serverIPAddress.lastIndexOf(':');\n\n    if (portPositionInString !== -1) {\n      serverIPAddress = serverIPAddress.substr(0, portPositionInString);\n    }\n\n    const timings: Timings = this.buildTimings();\n\n    const time: number = Object.values(timings).reduce(\n      (acc: number, t: number): number => acc + Math.max(t, 0),\n      0\n    );\n\n    const entry: any = {\n      startedDateTime: new Date(\n        this.request.getWallTime(this.request.issueTime) * 1000\n      ).toJSON(),\n      time,\n      timings,\n      request: await this.buildRequest(),\n      response: await this.buildResponse(),\n      cache: {},\n      // ADHOC: We should remove square brackets for IPv6 address (https://tools.ietf.org/html/rfc2373#section-2.2).\n      serverIPAddress: serverIPAddress.replace(/[[\\]]/g, ''),\n      _priority: this.request.priority,\n      _resourceType: this.request.resourceType,\n      _webSocketMessages: this.request.frames ?? [],\n      _eventSourceMessages: this.request.eventSourceMessages ?? []\n    };\n\n    if (this.request.connectionId !== '0') {\n      entry.connection = this.request.connectionId;\n    }\n\n    return entry;\n  }\n\n  private getResponseBodySize(): number {\n    if (this.request.statusCode === 304) {\n      return 0;\n    }\n\n    if (!this.request.responseHeadersText) {\n      return -1;\n    }\n\n    return this.request.transferSize - this.request.responseHeadersText.length;\n  }\n\n  private getResponseCompression(): number | undefined {\n    if (this.request.statusCode === 304 || this.request.statusCode === 206) {\n      return undefined;\n    }\n    if (!this.request.responseHeadersText) {\n      return undefined;\n    }\n\n    return this.request.resourceSize - this.getResponseBodySize();\n  }\n\n  private toMilliseconds(time: number): number {\n    return time === -1 ? -1 : time * 1000;\n  }\n\n  private async buildRequest(): Promise<Request> {\n    const res: Request = {\n      method: this.request.requestMethod,\n      url: this.buildRequestURL(this.request.url),\n      httpVersion: this.request.requestHttpVersion,\n      headers: this.request.requestHeaders,\n      queryString: [...(this.request.queryParameters ?? [])],\n      cookies: this.buildCookies(this.request.requestCookies ?? []),\n      headersSize: this.request.requestHeadersText?.length ?? -1,\n      bodySize: await this.requestBodySize()\n    };\n\n    const postData: PostData | undefined = await this.buildPostData();\n\n    if (postData) {\n      res.postData = postData;\n    }\n\n    return res;\n  }\n\n  private async buildResponse(): Promise<Response> {\n    return {\n      status: this.request.statusCode,\n      statusText: this.request.statusText,\n      httpVersion: this.request.responseHttpVersion(),\n      headers: this.request.responseHeaders,\n      cookies: this.buildCookies(this.request.responseCookies || []),\n      content: await this.buildContent(),\n      redirectURL: this.request.responseHeaderValue('Location') ?? '',\n      headersSize: this.request.responseHeadersText?.length ?? -1,\n      bodySize: this.getResponseBodySize(),\n      _transferSize: this.request.transferSize\n    };\n  }\n\n  private async buildContent(): Promise<Content> {\n    const data: ContentData | undefined = await this.request.contentData();\n\n    return Object.assign(\n      {\n        size: this.request.resourceSize,\n        mimeType: this.request.mimeType || 'x-unknown',\n        compression: this.getResponseCompression() ?? undefined\n      },\n      data\n    );\n  }\n\n  // eslint-disable-next-line complexity\n  private buildTimings(): Timings {\n    const timing = this.request.timing;\n    const issueTime: number = this.request.issueTime;\n    const startTime: number = this.request.startTime;\n\n    const result: Timings = {\n      blocked: -1,\n      dns: -1,\n      ssl: -1,\n      connect: -1,\n      send: 0,\n      wait: 0,\n      receive: 0\n    };\n\n    const queuedTime: number =\n      issueTime < startTime ? startTime - issueTime : -1;\n    result.blocked = this.toMilliseconds(queuedTime);\n\n    let highestTime = 0;\n\n    if (timing) {\n      const blockedStart = this.leastNonNegative([\n        timing.dnsStart,\n        timing.connectStart,\n        timing.sendStart\n      ]);\n      if (blockedStart !== Infinity) {\n        result.blocked += blockedStart;\n      }\n\n      const dnsStart: any = timing.dnsEnd >= 0 ? blockedStart : 0;\n      const dnsEnd: number = timing.dnsEnd >= 0 ? timing.dnsEnd : -1;\n      result.dns = dnsEnd - dnsStart;\n\n      const sslStart: number = timing.sslEnd > 0 ? timing.sslStart : 0;\n      const sslEnd: number = timing.sslEnd > 0 ? timing.sslEnd : -1;\n      result.ssl = sslEnd - sslStart;\n\n      const connectStart: number =\n        timing.connectEnd >= 0\n          ? this.leastNonNegative([dnsEnd, blockedStart])\n          : 0;\n      const connectEnd: number =\n        timing.connectEnd >= 0 ? timing.connectEnd : -1;\n      result.connect = connectEnd - connectStart;\n\n      const sendStart: number =\n        timing.sendEnd >= 0 ? Math.max(connectEnd, dnsEnd, blockedStart) : 0;\n      const sendEnd: number = timing.sendEnd >= 0 ? timing.sendEnd : 0;\n      result.send = sendEnd - sendStart;\n\n      if (result.send < 0) {\n        result.send = 0;\n      }\n\n      highestTime = Math.max(\n        sendEnd,\n        connectEnd,\n        sslEnd,\n        dnsEnd,\n        blockedStart,\n        0\n      );\n    } else if (this.request.responseReceivedTime === -1) {\n      result.blocked = this.request.endTime - issueTime;\n\n      return result;\n    }\n\n    const requestTime: number = timing?.requestTime ?? startTime;\n    const waitStart: number = highestTime;\n    const waitEnd: number = this.toMilliseconds(\n      this.request.responseReceivedTime - requestTime\n    );\n    result.wait = waitEnd - waitStart;\n\n    const receiveStart: number = waitEnd;\n    const receiveEnd: number = this.toMilliseconds(\n      this.request.endTime - requestTime\n    );\n    result.receive = Math.max(receiveEnd - receiveStart, 0);\n\n    return result;\n  }\n\n  private leastNonNegative(values: number[]): number {\n    const value: number | undefined = values.find(\n      (item: number): boolean => item >= 0\n    );\n\n    return value ?? -1;\n  }\n\n  private async buildPostData(): Promise<PostData | undefined> {\n    const postData: string | undefined = await this.request.requestFormData();\n\n    if (!postData) {\n      return undefined;\n    }\n\n    const res: Partial<PostData> = {\n      mimeType: this.request.requestContentType ?? '',\n      text: postData\n    };\n\n    const formParameters: Param[] = await this.request.formParameters();\n\n    if (formParameters) {\n      res.params = [...formParameters] as never;\n    }\n\n    return res as PostData;\n  }\n\n  private buildRequestURL(url: string): string {\n    return url.split('#', 2)[0];\n  }\n\n  private buildCookies(cookies: NetworkCookie[]): Cookie[] {\n    return cookies.map(this.buildCookie.bind(this));\n  }\n\n  private buildCookie(cookie: NetworkCookie): Cookie {\n    return {\n      name: cookie.name,\n      value: cookie.value,\n      path: cookie.path,\n      domain: cookie.domain,\n      expires: cookie\n        .expiresDate(\n          new Date(this.request.getWallTime(this.request.startTime) * 1000)\n        )\n        ?.toJSON(),\n      httpOnly: cookie.httpOnly,\n      secure: cookie.secure\n    };\n  }\n\n  private async requestBodySize(): Promise<number> {\n    const postData: string | undefined = await this.request.requestFormData();\n\n    if (!postData) {\n      return 0;\n    }\n\n    return this.request.contentLength;\n  }\n}\n","export class ErrorUtils {\n  public static isError(val: unknown): val is Error {\n    return val instanceof Error;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"os\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"util\");","import { EntryBuilder } from './EntryBuilder';\nimport type { NetworkRequest } from './NetworkRequest';\nimport type { HarExporter } from './HarExporter';\nimport type { Logger } from '../utils/Logger';\nimport { ErrorUtils } from '../utils/ErrorUtils';\nimport type {\n  DefaultHarExporterOptions,\n  Filter,\n  Transformer\n} from './DefaultHarExporterOptions';\nimport type { Entry } from 'har-format';\nimport type { WriteStream } from 'fs';\nimport { EOL } from 'os';\nimport { format, promisify } from 'util';\n\nexport class DefaultHarExporter implements HarExporter {\n  get path(): string {\n    const { path } = this.buffer;\n\n    return Buffer.isBuffer(path) ? path.toString('utf-8') : path;\n  }\n\n  private get filter(): Filter | undefined {\n    return this.options?.filter;\n  }\n\n  private get transform(): Transformer | undefined {\n    return this.options?.transform;\n  }\n\n  constructor(\n    private readonly logger: Logger,\n    private readonly buffer: WriteStream,\n    private readonly options?: DefaultHarExporterOptions\n  ) {}\n\n  public async write(networkRequest: NetworkRequest): Promise<void> {\n    const entry = await new EntryBuilder(networkRequest).build();\n\n    if (await this.applyFilter(entry)) {\n      return;\n    }\n\n    const json = await this.serializeEntry(entry);\n\n    if (!this.buffer.closed && json) {\n      // @ts-expect-error signature mismatch due to overloading issues\n      await promisify(this.buffer.write).call(this.buffer, `${json}${EOL}`);\n    }\n  }\n\n  public async serializeEntry(entry: Entry): Promise<string | undefined> {\n    try {\n      const result =\n        typeof this.transform === 'function'\n          ? await this.transform(entry)\n          : entry;\n\n      return JSON.stringify(result);\n    } catch (e) {\n      const stack = ErrorUtils.isError(e) ? e.stack : e;\n\n      this.logger.debug(\n        format(`The entry has been filtered out due to an error: %j`, entry)\n      );\n      this.logger.err(\n        `The entry is missing as a result of an error in the 'transform' function.\n\nThe stack trace for this error is:\n${stack}`\n      );\n\n      return undefined;\n    }\n  }\n\n  public end(): void {\n    this.buffer.end();\n  }\n\n  private async applyFilter(entry: Entry): Promise<unknown> {\n    try {\n      return typeof this.filter === 'function' && (await this.filter(entry));\n    } catch (e) {\n      const message = ErrorUtils.isError(e) ? e.message : e;\n\n      this.logger.debug(\n        `The operation has encountered an error while processing the entry. ${message}`\n      );\n\n      return false;\n    }\n  }\n}\n","import { ErrorUtils } from './ErrorUtils';\n\nexport class Loader {\n  public static async load<T>(path: string): Promise<T | undefined> {\n    let module: unknown;\n\n    try {\n      module = require(/* webpackIgnore: true */ path);\n    } catch (err) {\n      if (!this.shouldUseDynamicImport(err)) {\n        throw err;\n      }\n\n      module = (await import(/* webpackIgnore: true */ path)).default;\n    }\n\n    return this.interopRequireDefault<T | undefined>(module);\n  }\n\n  private static shouldUseDynamicImport(err: unknown): boolean {\n    const stack = ErrorUtils.isError(err) ? err.stack : undefined;\n\n    return !!(\n      stack?.includes('[ERR_REQUIRE_ESM]') ||\n      stack?.includes(\n        'SyntaxError: Cannot use import statement outside a module'\n      )\n    );\n  }\n\n  private static interopRequireDefault<T>(m: unknown): T | undefined {\n    // @ts-expect-error unknown is not assignable to the module type\n    return m && m.__esModule && m.default ? m.default : m;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"path\");","export enum CookieAttribute {\n  NAME = 'name',\n  VALUE = 'value',\n  SIZE = 'size',\n  DOMAIN = 'domain',\n  PORT = 'port',\n  PATH = 'path',\n  EXPIRES = 'expires',\n  HTTPONLY = 'httponly',\n  SECURE = 'secure',\n  SAMESITE = 'samesite',\n  MAXAGE = 'max-age'\n}\n\nexport class NetworkCookie {\n  private readonly _name: string;\n  private readonly _value: string;\n  private _attributes = new Map<CookieAttribute, string | undefined>();\n\n  private _size: number = 0;\n\n  get size(): number {\n    return this._size;\n  }\n\n  set size(size: number) {\n    this._size = size;\n  }\n\n  get name(): string {\n    return this._name;\n  }\n\n  get value(): string {\n    return this._value;\n  }\n\n  get httpOnly(): boolean {\n    return this._attributes.has(CookieAttribute.HTTPONLY);\n  }\n\n  get secure(): boolean {\n    return this._attributes.has(CookieAttribute.SECURE);\n  }\n\n  get sameSite(): 'Strict' | 'Lax' | 'None' | undefined {\n    return this._attributes.get(CookieAttribute.SAMESITE) as any;\n  }\n\n  get session(): boolean | undefined {\n    return !(\n      this._attributes.has(CookieAttribute.EXPIRES) ||\n      this._attributes.has(CookieAttribute.MAXAGE)\n    );\n  }\n\n  get path(): string | undefined {\n    return this._attributes.get(CookieAttribute.PATH);\n  }\n\n  get port(): string | undefined {\n    return this._attributes.get(CookieAttribute.PORT);\n  }\n\n  get domain(): string | undefined {\n    return this._attributes.get(CookieAttribute.DOMAIN);\n  }\n\n  get expires(): string | undefined {\n    return this._attributes.get(CookieAttribute.EXPIRES);\n  }\n\n  get maxAge(): number | undefined {\n    const maxAge: string = this._attributes.get(CookieAttribute.MAXAGE) ?? '';\n\n    return isNaN(+maxAge) ? undefined : +maxAge;\n  }\n\n  get url(): string {\n    return (this.secure ? 'https://' : 'http://') + this.domain + this.path;\n  }\n\n  constructor(name: string, value: string) {\n    this._name = name;\n    this._value = value;\n  }\n\n  public expiresDate(requestDate: Date): Date | undefined {\n    if (this.maxAge) {\n      const targetDate = requestDate === null ? new Date() : requestDate;\n\n      return new Date(targetDate.getTime() + 1000 * this.maxAge);\n    }\n\n    if (this.expires) {\n      return new Date(this.expires);\n    }\n\n    return undefined;\n  }\n\n  public addAttribute(key: string, value?: string): void {\n    this._attributes.set(key.toLowerCase() as CookieAttribute, value);\n  }\n}\n","import { CookieParser } from './CookieParser';\nimport { NetworkCookie } from './NetworkCookie';\nimport { StringUtils } from '../utils/StringUtils';\nimport type { RequestExtraInfo, ResponseExtraInfo } from './ExtraInfoBuilder';\nimport type { Header, Param, QueryString } from 'har-format';\nimport type Protocol from 'devtools-protocol';\n\nexport interface ContentData {\n  error?: string;\n  text?: string;\n  encoding?: string;\n}\n\nexport enum WebSocketFrameType {\n  REQUEST = 'request',\n  RESPONSE = 'response',\n  ERROR = 'error'\n}\n\nexport interface WebSocket {\n  type: WebSocketFrameType;\n  data: string;\n  time: Protocol.Network.MonotonicTime;\n  opcode: number;\n  mask: boolean;\n}\n\nexport interface EventSourceMessage {\n  time: number;\n  eventName: string;\n  eventId: string;\n  data: string;\n}\n\nexport class NetworkRequest {\n  private _contentData?: Promise<ContentData>;\n  private _wallIssueTime: Protocol.Network.TimeSinceEpoch = -1;\n  private _requestHeaderValues: Map<string, string> = new Map<string, string>();\n  private _responseHeaderValues: Map<string, string> = new Map<\n    string,\n    string\n  >();\n  private _parsedQueryParameters?: QueryString[];\n  private _currentPriority?: Protocol.Network.ResourcePriority;\n  private _requestFormData: Promise<string | undefined> =\n    Promise.resolve(undefined);\n  private _formParametersPromise?: Promise<Param[]>;\n\n  private _signedExchangeInfo?: Protocol.Network.SignedExchangeInfo;\n\n  // TODO: use to finalize a response in the `requestWillBeSent` event handler or\n  //  update `transferSize` for the chain of redirects\n  get signedExchangeInfo() {\n    return this._signedExchangeInfo;\n  }\n\n  set signedExchangeInfo(info) {\n    this._signedExchangeInfo = info;\n  }\n\n  private _hasExtraResponseInfo: boolean = false;\n\n  get hasExtraResponseInfo(): boolean {\n    return this._hasExtraResponseInfo;\n  }\n\n  set hasExtraResponseInfo(value: boolean) {\n    this._hasExtraResponseInfo = value;\n  }\n\n  private _hasExtraRequestInfo: boolean = false;\n\n  get hasExtraRequestInfo(): boolean {\n    return this._hasExtraRequestInfo;\n  }\n\n  set hasExtraRequestInfo(value: boolean) {\n    this._hasExtraRequestInfo = value;\n  }\n\n  private _connectionId: string = '0';\n\n  get connectionId() {\n    return this._connectionId;\n  }\n\n  set connectionId(value: string) {\n    this._connectionId = value;\n  }\n\n  private _protocol: string = '';\n\n  get protocol(): string {\n    return this._protocol;\n  }\n\n  set protocol(value: string) {\n    this._protocol = value ?? '';\n  }\n\n  private _requestTime: number = 0;\n\n  get requestTime(): number {\n    return this._requestTime;\n  }\n\n  set requestTime(value: number) {\n    this._requestTime = value ?? 0;\n  }\n\n  private _requestMethod: string = '';\n\n  get requestMethod(): string {\n    return this._requestMethod;\n  }\n\n  set requestMethod(value: string) {\n    this._requestMethod = value ?? '';\n  }\n\n  private _statusText: string = '';\n\n  get statusText(): string {\n    return this._statusText;\n  }\n\n  set statusText(value: string) {\n    this._statusText = value ?? '';\n  }\n\n  private _parsedURL!: URL;\n\n  get parsedURL() {\n    return this._parsedURL;\n  }\n\n  private _url!: string;\n\n  get url(): string {\n    return this._url;\n  }\n\n  set url(value: string) {\n    if (this._url === value) {\n      return;\n    }\n\n    this._url = value;\n    this._parsedURL = new URL(value);\n    delete this._queryString;\n    delete this._parsedQueryParameters;\n  }\n\n  private _remoteAddress: string = '';\n\n  get remoteAddress(): string {\n    return this._remoteAddress;\n  }\n\n  private _startTime: Protocol.Network.MonotonicTime = -1;\n\n  get startTime(): Protocol.Network.MonotonicTime {\n    return this._startTime || -1;\n  }\n\n  private _issueTime: Protocol.Network.MonotonicTime = -1;\n\n  get issueTime(): Protocol.Network.MonotonicTime {\n    return this._issueTime;\n  }\n\n  private _endTime: number = -1;\n\n  get endTime(): number {\n    return this._endTime || -1;\n  }\n\n  set endTime(x: number) {\n    if (this.timing && this.timing.requestTime) {\n      this._endTime = Math.max(x, this.responseReceivedTime);\n    } else {\n      this._endTime = x;\n      if (this._responseReceivedTime > x) {\n        this._responseReceivedTime = x;\n      }\n    }\n  }\n\n  private _responseReceivedTime: number = -1;\n\n  get responseReceivedTime(): number {\n    return this._responseReceivedTime || -1;\n  }\n\n  set responseReceivedTime(value: number) {\n    this._responseReceivedTime = value;\n  }\n\n  private _resourceSize: number = 0;\n\n  get resourceSize(): number {\n    return this._resourceSize || 0;\n  }\n\n  set resourceSize(value: number) {\n    this._resourceSize = value ?? 0;\n  }\n\n  private _transferSize: number = 0;\n\n  get transferSize(): number {\n    return this._transferSize || 0;\n  }\n\n  set transferSize(value: number) {\n    this._transferSize = value ?? 0;\n  }\n\n  private _timing?: Protocol.Network.ResourceTiming;\n\n  get timing() {\n    return this._timing;\n  }\n\n  set timing(timingInfo) {\n    if (!timingInfo) {\n      return;\n    }\n\n    this._startTime = timingInfo.requestTime;\n\n    const headersReceivedTime: number =\n      timingInfo.requestTime + timingInfo.receiveHeadersEnd / 1000.0;\n\n    if (\n      (this._responseReceivedTime || -1) < 0 ||\n      this._responseReceivedTime > headersReceivedTime\n    ) {\n      this._responseReceivedTime = headersReceivedTime;\n    }\n\n    if (this._startTime > this._responseReceivedTime) {\n      this._responseReceivedTime = this._startTime;\n    }\n\n    this._timing = timingInfo;\n  }\n\n  private _mimeType?: string;\n\n  get mimeType() {\n    return this._mimeType;\n  }\n\n  set mimeType(value) {\n    this._mimeType = value;\n  }\n\n  private _resourceType: Protocol.Network.ResourceType = 'Other';\n\n  get resourceType(): Protocol.Network.ResourceType {\n    return this._resourceType;\n  }\n\n  set resourceType(resourceType: Protocol.Network.ResourceType) {\n    this._resourceType = resourceType ?? 'Other';\n  }\n\n  private _redirectSource?: NetworkRequest;\n\n  get redirectSource() {\n    return this._redirectSource;\n  }\n\n  set redirectSource(originatingRequest) {\n    this._redirectSource = originatingRequest;\n  }\n\n  private _requestHeaders: Header[] = [];\n\n  get requestHeaders(): Header[] {\n    return this._requestHeaders;\n  }\n\n  set requestHeaders(headers: Header[]) {\n    this._requestHeaders = headers;\n    this._requestHeaderValues.clear();\n    delete this._requestCookies;\n  }\n\n  private _requestCookies?: NetworkCookie[];\n\n  get requestCookies(): NetworkCookie[] | undefined {\n    if (!this._requestCookies) {\n      const cookie = this.requestHeaderValue('Cookie');\n      this._requestCookies = cookie\n        ? new CookieParser().parseCookie(cookie)\n        : undefined;\n    }\n\n    return this._requestCookies;\n  }\n\n  get contentLength(): number {\n    const contentLength: string | undefined =\n      this.requestHeaderValue('Content-Length');\n\n    return contentLength == null || isNaN(+contentLength)\n      ? 0\n      : parseInt(contentLength, 10);\n  }\n\n  private _requestHeadersText: string = '';\n\n  get requestHeadersText(): string {\n    return this._requestHeadersText;\n  }\n\n  set requestHeadersText(text: string) {\n    this._requestHeadersText = text;\n  }\n\n  private _connectionReused: boolean = false;\n\n  get connectionReused(): boolean {\n    return this._connectionReused;\n  }\n\n  set connectionReused(value: boolean) {\n    this._connectionReused = value;\n  }\n\n  private _responseHeaders: Header[] = [];\n\n  get responseHeaders(): Header[] {\n    return this._responseHeaders || [];\n  }\n\n  set responseHeaders(value: Header[]) {\n    this._responseHeaders = value;\n    delete this._responseCookies;\n    this._responseHeaderValues.clear();\n  }\n\n  private _responseHeadersText: string = '';\n\n  get responseHeadersText(): string {\n    return this._responseHeadersText;\n  }\n\n  set responseHeadersText(value: string) {\n    this._responseHeadersText = value;\n  }\n\n  private _responseCookies?: NetworkCookie[];\n\n  get responseCookies(): NetworkCookie[] | undefined {\n    if (!this._responseCookies) {\n      const cookie = this.responseHeaderValue('Set-Cookie');\n      this._responseCookies = cookie\n        ? new CookieParser().parseSetCookie(cookie)\n        : undefined;\n    }\n\n    return this._responseCookies;\n  }\n\n  private _queryString?: string;\n\n  get queryString() {\n    if (this._queryString || !this.url) {\n      return this._queryString;\n    }\n\n    let queryString: string | undefined;\n    const questionMarkPosition = this.url.indexOf('?');\n\n    if (questionMarkPosition !== -1) {\n      queryString = this.url.substring(questionMarkPosition + 1);\n      const hashSignPosition = queryString.indexOf('#');\n\n      if (hashSignPosition !== -1) {\n        queryString = queryString.substring(0, hashSignPosition);\n      }\n    }\n\n    this._queryString = queryString;\n\n    return this._queryString;\n  }\n\n  private _initialPriority?: Protocol.Network.ResourcePriority;\n\n  get initialPriority() {\n    return this._initialPriority;\n  }\n\n  set initialPriority(priority) {\n    this._initialPriority = priority;\n  }\n\n  private _eventSourceMessages: EventSourceMessage[] = [];\n\n  get eventSourceMessages(): EventSourceMessage[] {\n    return this._eventSourceMessages;\n  }\n\n  private _frames: WebSocket[] = [];\n\n  get frames(): WebSocket[] {\n    return this._frames;\n  }\n\n  private _statusCode: number = 0;\n\n  get statusCode(): number {\n    return this._statusCode;\n  }\n\n  set statusCode(value: number) {\n    this._statusCode = value;\n  }\n\n  get requestId(): Protocol.Network.RequestId {\n    return this._requestId;\n  }\n\n  get requestHttpVersion(): string {\n    if (this.requestHeadersText) {\n      const firstLine = this.requestHeadersText.split(/\\r\\n/)[0];\n      const match = firstLine.match(/(HTTP\\/\\d+\\.\\d+)$/);\n\n      return match ? match[1] : 'HTTP/0.9';\n    }\n\n    const version =\n      this.requestHeaderValue('version') || this.requestHeaderValue(':version');\n    if (version) {\n      return version;\n    }\n\n    return this.getFilteredProtocolName();\n  }\n\n  get queryParameters(): QueryString[] | undefined {\n    if (this._parsedQueryParameters) {\n      return this._parsedQueryParameters;\n    }\n\n    if (this.queryString) {\n      this._parsedQueryParameters = this.parseParameters(this.queryString);\n    }\n\n    return this._parsedQueryParameters;\n  }\n\n  get requestContentType(): string | undefined {\n    return this.requestHeaderValue('Content-Type');\n  }\n\n  get priority(): Protocol.Network.ResourcePriority | undefined {\n    return this._currentPriority ?? this.initialPriority ?? undefined;\n  }\n\n  set priority(priority) {\n    this._currentPriority = priority;\n  }\n\n  constructor(\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    private _requestId: Protocol.Network.RequestId,\n    url: string,\n    public readonly documentURL: string,\n    public readonly loaderId: Protocol.Network.LoaderId,\n    public readonly initiator?: Protocol.Network.Initiator,\n    public readonly frameId: Protocol.Page.FrameId = ''\n  ) {\n    this.url = url;\n  }\n\n  public async waitForCompletion(): Promise<void> {\n    await Promise.all([this._contentData, this._formParametersPromise]);\n  }\n\n  public isBlob(): boolean {\n    return this._url.startsWith('blob:');\n  }\n\n  public setRemoteAddress(ip: string, port: number): void {\n    this._remoteAddress = `${ip}:${port}`;\n  }\n\n  public setIssueTime(\n    monotonicTime: Protocol.Network.MonotonicTime,\n    wallTime: Protocol.Network.TimeSinceEpoch\n  ): void {\n    this._issueTime = monotonicTime;\n    this._wallIssueTime = wallTime;\n    this._startTime = monotonicTime;\n  }\n\n  public increaseTransferSize(value: number): void {\n    this._transferSize = (this._transferSize || 0) + value;\n  }\n\n  public requestFormData(): Promise<string | undefined> {\n    return this._requestFormData;\n  }\n\n  public setRequestFormData(data: string | Promise<string | undefined>): void {\n    this._requestFormData =\n      typeof data === 'string' ? Promise.resolve(data) : data;\n    this._formParametersPromise = undefined;\n  }\n\n  public getWallTime(monotonicTime: Protocol.Network.MonotonicTime): number {\n    return this._wallIssueTime\n      ? this._wallIssueTime - this._issueTime + monotonicTime\n      : monotonicTime;\n  }\n\n  public formParameters(): Promise<Param[]> {\n    if (!this._formParametersPromise) {\n      this._formParametersPromise = this.parseFormParameters();\n    }\n\n    return this._formParametersPromise;\n  }\n\n  public responseHttpVersion(): string {\n    if (this._responseHeadersText) {\n      const firstLine: string = this._responseHeadersText.split(/\\r\\n/)[0];\n      const match: RegExpMatchArray | null =\n        firstLine.match(/^(HTTP\\/\\d+\\.\\d+)/);\n\n      return match ? match[1] : 'HTTP/0.9';\n    }\n\n    const version =\n      this.responseHeaderValue('version') ||\n      this.responseHeaderValue(':version');\n\n    if (version) {\n      return version;\n    }\n\n    return this.getFilteredProtocolName();\n  }\n\n  public setContentData(\n    data: Promise<Protocol.Network.GetResponseBodyResponse>\n  ): void {\n    if (this.resourceType === 'WebSocket') {\n      this._contentData = Promise.resolve({\n        error: 'Content for WebSockets is currently not supported'\n      });\n\n      return;\n    }\n\n    this._contentData = data\n      .then(\n        ({\n          body: text,\n          base64Encoded\n        }: Protocol.Network.GetResponseBodyResponse): ContentData => ({\n          text,\n          encoding: base64Encoded ? 'base64' : undefined\n        })\n      )\n      .catch((e: Error): ContentData => ({ error: e.message }));\n  }\n\n  public contentData(): Promise<ContentData> | undefined {\n    return this._contentData;\n  }\n\n  public addProtocolFrameError(\n    errorMessage: string,\n    time: Protocol.Network.MonotonicTime\n  ): void {\n    this.addFrame({\n      time,\n      type: WebSocketFrameType.ERROR,\n      data: errorMessage,\n      opcode: -1,\n      mask: false\n    });\n  }\n\n  public addProtocolFrame(\n    response: Protocol.Network.WebSocketFrame,\n    time: Protocol.Network.MonotonicTime,\n    sent: boolean\n  ): void {\n    const type: WebSocketFrameType = sent\n      ? WebSocketFrameType.REQUEST\n      : WebSocketFrameType.RESPONSE;\n\n    this.addFrame({\n      type,\n      time,\n      data: response.payloadData,\n      opcode: response.opcode,\n      mask: response.mask\n    });\n  }\n\n  public addEventSourceMessage(\n    time: number,\n    eventName: string,\n    eventId: string,\n    data: string\n  ) {\n    const message = { time, eventName, eventId, data };\n    this._eventSourceMessages.push(message);\n  }\n\n  public markAsRedirect(redirectCount: number): void {\n    this._requestId = `${this.requestId}:redirected.${redirectCount}`;\n  }\n\n  public addExtraRequestInfo(extraRequestInfo: RequestExtraInfo): void {\n    this.requestHeaders = extraRequestInfo.requestHeaders;\n    this._hasExtraRequestInfo = true;\n    this.requestHeadersText = '';\n  }\n\n  public addExtraResponseInfo(extraResponseInfo: ResponseExtraInfo): void {\n    this.responseHeaders = extraResponseInfo.responseHeaders;\n\n    if (extraResponseInfo.responseHeadersText) {\n      this.responseHeadersText = extraResponseInfo.responseHeadersText;\n\n      if (this.requestHeadersText) {\n        let requestHeadersText = `${this._requestMethod} ${this.parsedURL.pathname}`;\n\n        // eslint-disable-next-line max-depth\n        if (this.parsedURL.search) {\n          requestHeadersText += this.parsedURL.search;\n        }\n\n        requestHeadersText += ` HTTP/1.1\\r\\n`;\n\n        // eslint-disable-next-line max-depth\n        for (const { name, value } of this.requestHeaders) {\n          requestHeadersText += `${name}: ${value}\\r\\n`;\n        }\n\n        this.requestHeadersText = requestHeadersText;\n      }\n    }\n\n    this._hasExtraResponseInfo = true;\n  }\n\n  public responseHeaderValue(headerName: string): string | undefined {\n    if (!this._responseHeaderValues.has(headerName)) {\n      const headerValue = this.computeHeaderValue(\n        this.responseHeaders,\n        headerName\n      );\n      headerValue && this._responseHeaderValues.set(headerName, headerValue);\n    }\n\n    return this._responseHeaderValues.get(headerName);\n  }\n\n  private async parseFormParameters(): Promise<Param[]> {\n    if (\n      this.requestContentType?.match(\n        /^application\\/x-www-form-urlencoded\\s*(;.*)?$/i\n      )\n    ) {\n      const formUrlencoded = await this.requestFormData();\n\n      if (!formUrlencoded) {\n        return [];\n      }\n\n      return this.parseParameters(formUrlencoded);\n    }\n\n    const multipartDetails = this.requestContentType?.match(\n      /^multipart\\/form-data\\s*;\\s*boundary\\s*=\\s*(\\S+)\\s*$/\n    );\n\n    if (!multipartDetails) {\n      return [];\n    }\n\n    const boundary = multipartDetails[1];\n    const formData = await this.requestFormData();\n\n    if (!boundary || !formData) {\n      return [];\n    }\n\n    return this.parseMultipartFormDataParameters(formData, boundary);\n  }\n\n  private parseMultipartFormDataParameters(\n    data: string,\n    boundary: string\n  ): Param[] {\n    const sanitizedBoundary: string = StringUtils.escapeCharacters(boundary);\n    const keyValuePattern = new RegExp(\n      // Header with an optional file name.\n      '^\\\\r\\\\ncontent-disposition\\\\s*:\\\\s*form-data\\\\s*;\\\\s*name=\"([^\"]*)\"(?:\\\\s*;\\\\s*filename=\"([^\"]*)\")?' +\n        // Optional secondary header with the content type.\n        '(?:\\\\r\\\\ncontent-type\\\\s*:\\\\s*([^\\\\r\\\\n]*))?' +\n        // Padding.\n        '\\\\r\\\\n\\\\r\\\\n' +\n        // Value\n        '(.*)' +\n        // Padding.\n        '\\\\r\\\\n$',\n      'is'\n    );\n    const fields: string[] = data.split(\n      // eslint-disable-next-line no-useless-escape\n      new RegExp(`--${sanitizedBoundary}(?:--\\s*$)?`, 'g')\n    );\n\n    return fields.reduce((result: Param[], field: string): Param[] => {\n      const [match, name, fileName, contentType, value]: RegExpMatchArray =\n        field.match(keyValuePattern) ?? [];\n\n      if (!match) {\n        return result;\n      }\n\n      result.push({ name, value, fileName, contentType });\n\n      return result;\n    }, []);\n  }\n\n  private addFrame(frame: WebSocket): void {\n    this._frames.push(frame);\n  }\n\n  private requestHeaderValue(headerName: string): string | undefined {\n    if (!this._requestHeaderValues.has(headerName)) {\n      const headerValue = this.computeHeaderValue(\n        this.requestHeaders,\n        headerName\n      );\n      headerValue && this._requestHeaderValues.set(headerName, headerValue);\n    }\n\n    return this._requestHeaderValues.get(headerName);\n  }\n\n  private getFilteredProtocolName(): string {\n    const protocol = this._protocol.toLowerCase();\n\n    if (protocol === 'h2') {\n      return 'http/2.0';\n    }\n\n    return protocol.replace(/^http\\/2(\\.0)?\\+/, 'http/2.0+');\n  }\n\n  private parseParameters(queryString: string): QueryString[] {\n    return queryString.split('&').map((pair: string): QueryString => {\n      const position: number = pair.indexOf('=');\n      if (position === -1) {\n        return { name: pair, value: '' };\n      } else {\n        return {\n          name: pair.substring(0, position),\n          value: pair.substring(position + 1)\n        };\n      }\n    });\n  }\n\n  private computeHeaderValue(\n    headers: Header[],\n    headerName: string\n  ): string | undefined {\n    headerName = headerName.toLowerCase();\n\n    const values: string[] = headers\n      .filter(({ name }: Header): boolean => name.toLowerCase() === headerName)\n      .map(({ value }: Header): string => value);\n\n    if (!values.length) {\n      return undefined;\n    }\n\n    // Set-Cookie values should be separated by '\\n', not comma, otherwise cookies could not be parsed.\n    if (headerName === 'set-cookie') {\n      return values.join('\\n');\n    }\n\n    return values.join(', ');\n  }\n}\n","import { NetworkCookie } from './NetworkCookie';\n\ninterface KeyValue {\n  key: string;\n  value?: string;\n  position: number;\n}\n\nexport class CookieParser {\n  private _input?: string;\n  private _originalInputLength?: number;\n  private _lastCookie?: NetworkCookie;\n  private _lastCookiePosition: number = 0;\n  private _cookies?: NetworkCookie[];\n\n  public parseCookie(cookieHeader: string): NetworkCookie[] | undefined {\n    this._initialize(cookieHeader);\n\n    for (let kv = this._extractKeyValue(); kv; kv = this._extractKeyValue()) {\n      if (kv.key.charAt(0) === '$' && this._lastCookie) {\n        this._lastCookie.addAttribute(kv.key.slice(1), kv.value);\n      } else if (\n        kv.key.toLowerCase() !== '$version' &&\n        typeof kv.value === 'string'\n      ) {\n        this.addCookie(kv);\n      }\n\n      this.advanceAndCheckCookieDelimiter();\n    }\n\n    this.flushCookie();\n\n    return this._cookies;\n  }\n\n  public parseSetCookie(setCookieHeader: string): NetworkCookie[] | undefined {\n    this._initialize(setCookieHeader);\n\n    for (let kv = this._extractKeyValue(); kv; kv = this._extractKeyValue()) {\n      if (this._lastCookie) {\n        this._lastCookie.addAttribute(kv.key, kv.value);\n      } else {\n        this.addCookie(kv);\n      }\n      if (this.advanceAndCheckCookieDelimiter()) {\n        this.flushCookie();\n      }\n    }\n    this.flushCookie();\n\n    return this._cookies;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _initialize(headerValue: string): void {\n    this._input = headerValue;\n    this._cookies = [];\n    this._lastCookie = undefined;\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this._originalInputLength = this._input.length;\n  }\n\n  private flushCookie(): void {\n    if (this._lastCookie) {\n      /* eslint-disable @typescript-eslint/no-non-null-assertion */\n      this._lastCookie.size =\n        this._originalInputLength! -\n        this._input!.length -\n        this._lastCookiePosition;\n      /* eslint-enable @typescript-eslint/no-non-null-assertion */\n    }\n\n    delete this._lastCookie;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _extractKeyValue(): KeyValue | undefined {\n    if (!this._input?.length) {\n      return undefined;\n    }\n\n    // Note: RFCs offer an option for quoted values that may contain commas and semicolons.\n    // Many browsers/platforms do not support this, however (see http://webkit.org/b/16699\n    // and http://crbug.com/12361). The logic below matches latest versions of IE, Firefox,\n    // Chrome and Safari on some old platforms. The latest version of Safari supports quoted\n    // cookie values, though.\n    const keyValueMatch = /^[ \\t]*([^\\s=;]+)[ \\t]*(?:=[ \\t]*([^;\\n]*))?/i.exec(\n      this._input\n    );\n\n    if (!keyValueMatch) {\n      return undefined;\n    }\n\n    const result: KeyValue = {\n      key: this.toCamelCase(keyValueMatch[1]),\n      value: keyValueMatch[2]?.trim(),\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      position: this._originalInputLength! - this._input.length\n    };\n\n    this._input = this._input.slice(keyValueMatch[0].length);\n\n    return result;\n  }\n\n  private toCamelCase(str: string): string {\n    return str\n      .replace(/\\s(.)/g, (m: string): string => m.toUpperCase())\n      .replace(/\\s/g, '')\n      .replace(/^(.)/, (m: string): string => m.toLowerCase());\n  }\n\n  private advanceAndCheckCookieDelimiter(): boolean {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    const match: RegExpExecArray | null = /^\\s*[\\n;]\\s*/.exec(this._input!);\n\n    if (!match) {\n      return false;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this._input = this._input!.slice(match[0].length);\n\n    return match[0].match('\\n') !== null;\n  }\n\n  private addCookie(keyValue: KeyValue): void {\n    if (this._lastCookie) {\n      this._lastCookie.size = keyValue.position - this._lastCookiePosition;\n    }\n\n    this._lastCookie =\n      typeof keyValue.value === 'string'\n        ? new NetworkCookie(keyValue.key, keyValue.value)\n        : new NetworkCookie('', keyValue.key);\n\n    this._lastCookiePosition = keyValue.position;\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this._cookies!.push(this._lastCookie);\n  }\n}\n","export class StringUtils {\n  public static isString(value: unknown): value is string {\n    return typeof value === 'string';\n  }\n\n  public static toRegexSource(pattern: RegExp | string): string {\n    return this.isString(pattern) ? pattern : pattern.source;\n  }\n\n  public static toRegex(pattern: RegExp | string): RegExp {\n    return this.isString(pattern) ? new RegExp(pattern) : pattern;\n  }\n\n  public static dirname(path: string): string {\n    const normalizedPath = this.removeTrailingSlash(path);\n    const fileNameIdx = this.fileNameIdx(normalizedPath);\n    const dirname = normalizedPath.substring(0, fileNameIdx);\n\n    return this.removeTrailingSlash(dirname);\n  }\n\n  public static normalizeName(\n    path: string,\n    options?: { ext?: string }\n  ): string {\n    const fileNameIdx = this.fileNameIdx(path);\n    const name = this.removeLeadingSlash(path.substring(fileNameIdx));\n\n    const extIdx = name.lastIndexOf('.');\n\n    let ext: string | undefined;\n    let nameWithoutExt = name;\n\n    if (extIdx >= 0) {\n      ext = options?.ext ?? name.substring(extIdx);\n      nameWithoutExt = name.substring(0, extIdx);\n    }\n\n    return `${nameWithoutExt}${ext ?? '.har'}`;\n  }\n\n  public static escapeCharacters(\n    str: string,\n    chars: string = '^[]{}()\\\\\\\\.$*+?|'\n  ): string {\n    let foundChar = false;\n\n    const length = chars.length;\n\n    for (let i = 0; i < length; ++i) {\n      if (str.indexOf(chars.charAt(i)) !== -1) {\n        foundChar = true;\n        break;\n      }\n    }\n\n    if (!foundChar) {\n      return str;\n    }\n\n    let result = '';\n\n    for (let j = 0; j < str.length; ++j) {\n      if (chars.indexOf(str.charAt(j)) !== -1) {\n        result += '\\\\';\n      }\n\n      result += str.charAt(j);\n    }\n\n    return result;\n  }\n\n  private static fileNameIdx(path: string): number {\n    return path.indexOf('\\\\') >= 0\n      ? path.lastIndexOf('\\\\')\n      : path.lastIndexOf('/');\n  }\n\n  private static removeLeadingSlash(path: string): string {\n    return path.replace(/^\\/|^\\\\/, '');\n  }\n\n  private static removeTrailingSlash(path: string): string {\n    return path.replace(/\\/+$|\\\\+$/, '');\n  }\n}\n","import { NetworkRequest } from './NetworkRequest';\nimport type { Header } from 'har-format';\n\nexport interface RequestExtraInfo {\n  requestHeaders: Header[];\n}\n\nexport interface ResponseExtraInfo {\n  responseHeaders: Header[];\n  responseHeadersText?: string;\n}\n\nexport class ExtraInfoBuilder {\n  private _hasExtraInfo: boolean = false;\n  private _finished: boolean = false;\n  private readonly _requests: NetworkRequest[] = [];\n  private readonly _requestExtraInfo: RequestExtraInfo[] = [];\n  private readonly _responseExtraInfo: ResponseExtraInfo[] = [];\n\n  constructor(private readonly deleteCallback: () => void) {}\n\n  public addRequest(request: NetworkRequest): void {\n    this._requests.push(request);\n    this.sync();\n  }\n\n  public addRequestExtraInfo(info: RequestExtraInfo): void {\n    this._requestExtraInfo.push(info);\n    this._hasExtraInfo = true;\n    this.sync();\n  }\n\n  public addResponseExtraInfo(info: ResponseExtraInfo): void {\n    this._responseExtraInfo.push(info);\n    this.sync();\n  }\n\n  public finished(): void {\n    this._finished = true;\n    this.deleteIfComplete();\n  }\n\n  private deleteIfComplete(): void {\n    if (!this._finished) {\n      return;\n    }\n\n    if (this._hasExtraInfo) {\n      const lastRequest: NetworkRequest | undefined = this.getLastRequest();\n\n      if (!lastRequest?.hasExtraResponseInfo) {\n        return;\n      }\n    }\n\n    this.deleteCallback();\n  }\n\n  private getLastRequest(): NetworkRequest | undefined {\n    return this._requests[this._requests.length - 1];\n  }\n\n  private getRequestIndex(req: NetworkRequest): number {\n    return this._requests.indexOf(req);\n  }\n\n  private sync(): void {\n    const req: NetworkRequest | undefined = this.getLastRequest();\n\n    if (!req) {\n      return;\n    }\n\n    const index: number = this.getRequestIndex(req);\n\n    const requestExtraInfo: RequestExtraInfo | undefined =\n      this._requestExtraInfo[index];\n\n    if (requestExtraInfo) {\n      req.addExtraRequestInfo(requestExtraInfo);\n      delete this._requestExtraInfo[index];\n    }\n\n    const responseExtraInfo: ResponseExtraInfo | undefined =\n      this._responseExtraInfo[index];\n    if (responseExtraInfo) {\n      req.addExtraResponseInfo(responseExtraInfo);\n      delete this._responseExtraInfo[index];\n    }\n\n    this.deleteIfComplete();\n  }\n}\n","import { Logger } from '../utils/Logger';\nimport { NetworkRequest } from './NetworkRequest';\nimport { ExtraInfoBuilder } from './ExtraInfoBuilder';\nimport type { NetworkObserverOptions } from './NetworkObserverOptions';\nimport type { Observer } from './Observer';\nimport type { RequestFilter } from './filters';\nimport type { Network, NetworkEvent } from './Network';\nimport type Protocol from 'devtools-protocol';\nimport type { Header } from 'har-format';\n\nexport class NetworkObserver implements Observer<NetworkRequest> {\n  private readonly _entries: Map<Protocol.Network.RequestId, NetworkRequest>;\n  private readonly _extraInfoBuilders: Map<\n    Protocol.Network.RequestId,\n    ExtraInfoBuilder\n  >;\n  private destination?: (chromeEntry: NetworkRequest) => unknown;\n\n  get empty(): boolean {\n    return this._entries.size === 0;\n  }\n\n  constructor(\n    private readonly options: NetworkObserverOptions,\n    private readonly network: Network,\n    private readonly logger: Logger,\n    private readonly requestFilter?: RequestFilter\n  ) {\n    this._entries = new Map<Protocol.Network.RequestId, NetworkRequest>();\n    this._extraInfoBuilders = new Map<\n      Protocol.Network.RequestId,\n      ExtraInfoBuilder\n    >();\n  }\n\n  public async subscribe(\n    callback: (chromeEntry: NetworkRequest) => unknown\n  ): Promise<void> {\n    this.destination = callback;\n\n    await this.network.attachToTargets((event: NetworkEvent): void =>\n      this.handleEvent(event)\n    );\n  }\n\n  public async unsubscribe(): Promise<void> {\n    await this.network.detachFromTargets();\n    delete this.destination;\n    this._entries.clear();\n    this._extraInfoBuilders.clear();\n  }\n\n  public signedExchangeReceived(\n    params: Protocol.Network.SignedExchangeReceivedEvent\n  ): void {\n    const entry: NetworkRequest | undefined = this._entries.get(\n      params.requestId\n    );\n    if (!entry) {\n      return;\n    }\n\n    entry.signedExchangeInfo = params.info;\n    entry.resourceType = 'SignedExchange';\n\n    this.updateNetworkRequestWithResponse(entry, params.info.outerResponse);\n  }\n\n  public requestWillBeSent({\n    type,\n    loaderId,\n    initiator,\n    redirectResponse,\n    documentURL,\n    frameId,\n    timestamp,\n    requestId,\n    request,\n    wallTime\n  }: Protocol.Network.RequestWillBeSentEvent): void {\n    let entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (entry) {\n      if (!redirectResponse) {\n        return;\n      }\n\n      if (!entry.signedExchangeInfo) {\n        this.responseReceived({\n          requestId,\n          loaderId,\n          timestamp,\n          frameId,\n          type: 'Other',\n          response: redirectResponse\n        });\n      }\n      entry = this._appendRedirect(requestId, timestamp, request.url);\n    } else {\n      entry = this.createRequest(\n        requestId,\n        frameId,\n        loaderId,\n        request.url,\n        documentURL,\n        initiator\n      );\n    }\n\n    this.updateNetworkRequestWithRequest(entry, request);\n\n    entry.setIssueTime(timestamp, wallTime);\n    entry.resourceType = type ?? 'Other';\n\n    this.getExtraInfoBuilder(requestId).addRequest(entry);\n\n    this.startRequest(entry);\n  }\n\n  public dataReceived({\n    requestId,\n    dataLength,\n    encodedDataLength,\n    timestamp\n  }: Protocol.Network.DataReceivedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n    if (!entry) {\n      return;\n    }\n    entry.resourceSize += dataLength;\n    if (encodedDataLength !== -1) {\n      entry.increaseTransferSize(encodedDataLength);\n    }\n    entry.endTime = timestamp;\n  }\n\n  public responseReceived({\n    requestId,\n    response,\n    timestamp,\n    type\n  }: Omit<Protocol.Network.ResponseReceivedEvent, 'hasExtraInfo'>): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.responseReceivedTime = timestamp;\n    entry.resourceType = type;\n\n    this.updateNetworkRequestWithResponse(entry, response);\n  }\n\n  public resourceChangedPriority({\n    requestId,\n    newPriority\n  }: Protocol.Network.ResourceChangedPriorityEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.priority = newPriority;\n  }\n\n  public async loadingFinished({\n    requestId,\n    timestamp,\n    encodedDataLength\n  }: Protocol.Network.LoadingFinishedEvent): Promise<void> {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    this.finishRequest(entry, timestamp, encodedDataLength);\n  }\n\n  public loadingFailed({\n    requestId,\n    errorText,\n    canceled,\n    type,\n    timestamp\n  }: Protocol.Network.LoadingFailedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n    if (!entry) {\n      return;\n    }\n\n    entry.resourceType = type;\n\n    this.finishRequest(entry, timestamp, -1);\n\n    const message = errorText || (canceled && 'Canceled');\n    this.logger.debug(`Failed request: ${requestId}. Reason: ${message}`);\n  }\n\n  public webSocketCreated({\n    initiator,\n    requestId,\n    url\n  }: Protocol.Network.WebSocketCreatedEvent): void {\n    const entry: NetworkRequest = this.createRequest(\n      requestId,\n      '',\n      '',\n      url,\n      '',\n      initiator\n    );\n    this.startRequest(entry);\n  }\n\n  public eventSourceMessageReceived({\n    requestId,\n    timestamp,\n    eventName,\n    eventId,\n    data\n  }: Protocol.Network.EventSourceMessageReceivedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n    if (!entry) {\n      return;\n    }\n    entry.addEventSourceMessage(timestamp, eventName, eventId, data);\n  }\n\n  public webSocketWillSendHandshakeRequest({\n    request,\n    requestId,\n    timestamp,\n    wallTime\n  }: Protocol.Network.WebSocketWillSendHandshakeRequestEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n    if (!entry) {\n      return;\n    }\n    entry.requestMethod = 'GET';\n    entry.requestHeaders = this.headersMapToHeadersArray(request.headers);\n    entry.setIssueTime(timestamp, wallTime);\n  }\n\n  public webSocketHandshakeResponseReceived({\n    timestamp,\n    response,\n    requestId\n  }: Protocol.Network.WebSocketHandshakeResponseReceivedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.statusCode = response.status;\n    entry.statusText = response.statusText;\n    entry.responseHeaders = this.headersMapToHeadersArray(response.headers);\n    entry.responseHeadersText = response.headersText || '';\n\n    if (response.requestHeaders) {\n      entry.requestHeaders = this.headersMapToHeadersArray(\n        response.requestHeaders\n      );\n    }\n\n    if (response.requestHeadersText) {\n      entry.requestHeadersText = response.requestHeadersText;\n    }\n\n    entry.responseReceivedTime = timestamp;\n    entry.protocol = 'websocket';\n  }\n\n  public webSocketFrameSent({\n    requestId,\n    timestamp,\n    response\n  }: Protocol.Network.WebSocketFrameSentEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.addProtocolFrame(response, timestamp, true);\n    entry.responseReceivedTime = timestamp;\n  }\n\n  public webSocketFrameReceived({\n    requestId,\n    timestamp,\n    response\n  }: Protocol.Network.WebSocketFrameReceivedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.addProtocolFrame(response, timestamp, false);\n    entry.responseReceivedTime = timestamp;\n  }\n\n  public webSocketFrameError({\n    errorMessage,\n    requestId,\n    timestamp\n  }: Protocol.Network.WebSocketFrameErrorEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    entry.addProtocolFrameError(errorMessage, timestamp);\n    entry.responseReceivedTime = timestamp;\n  }\n\n  public webSocketClosed({\n    requestId,\n    timestamp\n  }: Protocol.Network.WebSocketClosedEvent): void {\n    const entry: NetworkRequest | undefined = this._entries.get(requestId);\n\n    if (!entry) {\n      return;\n    }\n\n    this.finishRequest(entry, timestamp, -1);\n  }\n\n  public requestWillBeSentExtraInfo({\n    requestId,\n    headers\n  }: Protocol.Network.RequestWillBeSentExtraInfoEvent): void {\n    this.getExtraInfoBuilder(requestId).addRequestExtraInfo({\n      requestHeaders: this.headersMapToHeadersArray(headers)\n    });\n  }\n\n  public responseReceivedExtraInfo({\n    requestId,\n    headers,\n    headersText\n  }: Protocol.Network.ResponseReceivedExtraInfoEvent): void {\n    this.getExtraInfoBuilder(requestId).addResponseExtraInfo({\n      responseHeaders: this.headersMapToHeadersArray(headers),\n      responseHeadersText: headersText\n    });\n  }\n\n  private getExtraInfoBuilder(\n    requestId: Protocol.Network.RequestId\n  ): ExtraInfoBuilder {\n    if (!this._extraInfoBuilders.has(requestId)) {\n      this._extraInfoBuilders.set(\n        requestId,\n        new ExtraInfoBuilder((): void => {\n          this._extraInfoBuilders.delete(requestId);\n        })\n      );\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return this._extraInfoBuilders.get(requestId)!;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  private _appendRedirect(\n    requestId: Protocol.Network.RequestId,\n    time: Protocol.Network.MonotonicTime,\n    redirectURL: string\n  ): NetworkRequest {\n    const originalNetworkRequest: NetworkRequest = this._entries.get(\n      requestId\n    ) as NetworkRequest;\n\n    let redirectCount = 0;\n    let redirect: NetworkRequest | undefined =\n      originalNetworkRequest.redirectSource;\n\n    while (redirect) {\n      redirectCount++;\n      redirect = redirect.redirectSource;\n    }\n\n    originalNetworkRequest.markAsRedirect(redirectCount);\n\n    this.finishRequest(originalNetworkRequest, time, -1);\n\n    const newNetworkRequest: NetworkRequest = this.createRequest(\n      requestId,\n      originalNetworkRequest.frameId,\n      originalNetworkRequest.loaderId,\n      redirectURL,\n      originalNetworkRequest.documentURL,\n      originalNetworkRequest.initiator\n    );\n\n    newNetworkRequest.redirectSource = originalNetworkRequest;\n\n    return newNetworkRequest;\n  }\n\n  private finishRequest(\n    networkRequest: NetworkRequest,\n    finishTime: Protocol.Network.MonotonicTime,\n    encodedDataLength: number\n  ): void {\n    networkRequest.endTime = finishTime;\n\n    if (encodedDataLength >= 0) {\n      const redirectSource: NetworkRequest | undefined =\n        networkRequest.redirectSource;\n\n      if (redirectSource?.signedExchangeInfo) {\n        networkRequest.transferSize = 0;\n        redirectSource.transferSize = encodedDataLength;\n      } else {\n        networkRequest.transferSize = encodedDataLength;\n      }\n    }\n\n    this.loadContent(networkRequest);\n\n    this.getExtraInfoBuilder(networkRequest.requestId).finished();\n\n    if (!this.shouldExcludeRequest(networkRequest)) {\n      networkRequest\n        .waitForCompletion()\n        .then(() => this.destination?.(networkRequest))\n        .finally(() => this._entries.delete(networkRequest.requestId));\n    }\n  }\n\n  private loadContent(networkRequest: NetworkRequest): void {\n    if (networkRequest.mimeType && this.options.content) {\n      networkRequest.setContentData(\n        this.network.getResponseBody(networkRequest.requestId)\n      );\n    }\n  }\n\n  private startRequest(networkRequest: NetworkRequest): void {\n    this._entries.set(networkRequest.requestId, networkRequest);\n  }\n\n  private updateNetworkRequestWithRequest(\n    chromeRequest: NetworkRequest,\n    request: Protocol.Network.Request\n  ): void {\n    chromeRequest.requestMethod = request.method;\n    chromeRequest.requestHeaders = this.headersMapToHeadersArray(\n      request.headers\n    );\n    chromeRequest.setRequestFormData(\n      request.hasPostData\n        ? this.getRequestPostData(chromeRequest, request)\n        : Promise.resolve(undefined)\n    );\n    chromeRequest.initialPriority = request.initialPriority;\n  }\n\n  private getRequestPostData(\n    request: NetworkRequest,\n    rawRequest: Protocol.Network.Request\n  ): Promise<string | undefined> {\n    return rawRequest.postData !== undefined\n      ? Promise.resolve(rawRequest.postData)\n      : this.network\n          .getRequestBody(request.requestId)\n          .then(\n            ({\n              postData\n            }: Protocol.Network.GetRequestPostDataResponse): string => postData\n          )\n          .catch(() => undefined);\n  }\n\n  private createRequest(\n    requestId: Protocol.Network.RequestId,\n    frameId: string | undefined,\n    loaderId: Protocol.Network.LoaderId,\n    url: string,\n    documentURL: string,\n    initiator?: Protocol.Network.Initiator\n  ): NetworkRequest {\n    return new NetworkRequest(\n      requestId,\n      url,\n      documentURL,\n      loaderId,\n      initiator,\n      frameId\n    );\n  }\n\n  // eslint-disable-next-line complexity\n  private updateNetworkRequestWithResponse(\n    networkRequest: NetworkRequest,\n    response: Protocol.Network.Response\n  ): void {\n    if (response.url && networkRequest.url !== response.url) {\n      networkRequest.url = response.url;\n    }\n    networkRequest.mimeType = response.mimeType;\n    networkRequest.statusCode = response.status;\n    networkRequest.statusText = response.statusText;\n\n    if (!networkRequest.hasExtraResponseInfo) {\n      networkRequest.responseHeaders = this.headersMapToHeadersArray(\n        response.headers\n      );\n    }\n\n    if (response.encodedDataLength >= 0) {\n      networkRequest.transferSize = response.encodedDataLength;\n    }\n\n    if (response.requestHeaders && !networkRequest.hasExtraRequestInfo) {\n      networkRequest.requestHeaders = this.headersMapToHeadersArray(\n        response.requestHeaders\n      );\n      networkRequest.requestHeadersText = response.requestHeadersText ?? '';\n    }\n\n    networkRequest.connectionReused = response.connectionReused;\n    networkRequest.connectionId = String(response.connectionId);\n\n    if (response.remoteIPAddress) {\n      networkRequest.setRemoteAddress(\n        response.remoteIPAddress,\n        response.remotePort || -1\n      );\n    }\n\n    if (response.timing) {\n      networkRequest.timing = response.timing;\n    }\n\n    networkRequest.protocol = response.protocol ?? '';\n  }\n\n  private headersMapToHeadersArray(\n    headersMap: Protocol.Network.Headers\n  ): Header[] {\n    return Object.keys(headersMap).reduce(\n      (acc: Header[], name: string): Header[] => {\n        const values: string[] = headersMap[name].split('\\n');\n\n        acc.push(...values.map((value: string): Header => ({ name, value })));\n\n        return acc;\n      },\n      []\n    );\n  }\n\n  private shouldExcludeRequest(request: NetworkRequest): boolean {\n    return this.requestFilter?.wouldApply(this.options)\n      ? !this.requestFilter.apply(request, this.options)\n      : false;\n  }\n\n  private handleEvent({ method, params, sessionId }: NetworkEvent): void {\n    const methodName = method.substring(method.indexOf('.') + 1);\n\n    if (typeof this[methodName] === 'function') {\n      this[methodName](params, sessionId);\n    }\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\nimport { StringUtils } from '../../utils/StringUtils';\n\nexport class HostFilter implements RequestFilter {\n  public apply(\n    request: NetworkRequest,\n    { includeHosts }: RequestFilterOptions\n  ): boolean {\n    const { host } = request.parsedURL;\n\n    return !!includeHosts?.some(pattern =>\n      StringUtils.toRegex(pattern).test(host)\n    );\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    return (\n      Array.isArray(options.includeHosts) && options.includeHosts.length > 0\n    );\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\nimport { StringUtils } from '../../utils/StringUtils';\n\nexport class PathFilter implements RequestFilter {\n  public apply(\n    request: NetworkRequest,\n    { excludePaths }: RequestFilterOptions\n  ): boolean {\n    const { pathname = '/' } = request.parsedURL;\n\n    return !excludePaths?.some(pattern =>\n      StringUtils.toRegex(pattern).test(pathname)\n    );\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    return (\n      Array.isArray(options.excludePaths) && options.excludePaths.length > 0\n    );\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\n\nexport class MimeFilter implements RequestFilter {\n  public apply(\n    request: NetworkRequest,\n    { includeMimes }: RequestFilterOptions\n  ): boolean {\n    return !!(request.mimeType && includeMimes?.includes(request.mimeType));\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    return (\n      Array.isArray(options.includeMimes) && options.includeMimes.length > 0\n    );\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\n\nexport class MinStatusCodeFilter implements RequestFilter {\n  public apply(\n    request: NetworkRequest,\n    { minStatusCodeToInclude }: RequestFilterOptions\n  ): boolean {\n    const threshold = this.normalizeThreshold(minStatusCodeToInclude) ?? 0;\n\n    return request.statusCode >= threshold;\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    const threshold = this.normalizeThreshold(options.minStatusCodeToInclude);\n\n    return typeof threshold === 'number';\n  }\n\n  private normalizeThreshold(\n    value: number | string | undefined\n  ): number | undefined {\n    return value != null && !isNaN(+value)\n      ? Math.round(Math.abs(+value))\n      : undefined;\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\n\nexport class BlobFilter implements RequestFilter {\n  public apply(request: NetworkRequest, _: RequestFilterOptions): boolean {\n    return !request.isBlob();\n  }\n\n  public wouldApply({ includeBlobs }: RequestFilterOptions): boolean {\n    return !(includeBlobs ?? true);\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\n\nexport class StatusCodeFilter implements RequestFilter {\n  public apply(\n    request: NetworkRequest,\n    { excludeStatusCodes }: RequestFilterOptions\n  ): boolean {\n    return !excludeStatusCodes?.includes(request.statusCode);\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    return (\n      Array.isArray(options.excludeStatusCodes) &&\n      options.excludeStatusCodes.length > 0\n    );\n  }\n}\n","import { NetworkRequest } from '../NetworkRequest';\nimport { HostFilter } from './HostFilter';\nimport { PathFilter } from './PathFilter';\nimport { MimeFilter } from './MimeFilter';\nimport { MinStatusCodeFilter } from './MinStatusCodeFilter';\nimport { BlobFilter } from './BlobFilter';\nimport { StatusCodeFilter } from './StatusCodeFilter';\nimport type { RequestFilter, RequestFilterOptions } from './RequestFilter';\n\nexport class CompositeFilter implements RequestFilter {\n  constructor(\n    private readonly children: RequestFilter[] = [\n      new HostFilter(),\n      new PathFilter(),\n      new MimeFilter(),\n      new BlobFilter(),\n      new MinStatusCodeFilter(),\n      new StatusCodeFilter()\n    ]\n  ) {}\n\n  public apply(\n    request: NetworkRequest,\n    options: RequestFilterOptions\n  ): boolean {\n    return this.children\n      .filter(x => x.wouldApply(options))\n      .every(x => x.apply(request, options));\n  }\n\n  public wouldApply(options: RequestFilterOptions): boolean {\n    return this.children.some(x => x.wouldApply(options));\n  }\n}\n","import type { Entry, Har } from 'har-format';\n\nexport class HarBuilder {\n  constructor(private readonly entries: Entry[]) {}\n\n  public build(): Har {\n    // eslint-disable-next-line @typescript-eslint/no-var-requires\n    const { name, version, homepage: comment } = require('../../package.json');\n\n    return {\n      log: {\n        version: '1.2',\n        pages: [],\n        creator: {\n          name,\n          version,\n          comment\n        },\n        entries: this.entries\n      }\n    };\n  }\n}\n","import { NetworkRequest } from './NetworkRequest';\nimport type { Observer } from './Observer';\nimport { promisify } from 'util';\n\nexport class NetworkIdleMonitor {\n  private startIdleTime?: number;\n\n  constructor(private readonly networkObservable: Observer<NetworkRequest>) {}\n\n  public async waitForIdle(idleTime: number): Promise<void> {\n    for (;;) {\n      this.startIdleTime = this.networkObservable.empty\n        ? this.startIdleTimer()\n        : undefined;\n\n      if (this.shouldResolve(idleTime)) {\n        return;\n      }\n\n      await promisify(setTimeout)(idleTime);\n    }\n  }\n\n  private startIdleTimer(): number {\n    if (!this.startIdleTime) {\n      this.startIdleTime = Date.now();\n    }\n\n    return this.startIdleTime;\n  }\n\n  private shouldResolve(idleTime: number): boolean {\n    return !!(\n      this.startIdleTime && Date.now() - this.startIdleTime >= idleTime\n    );\n  }\n}\n","export const PORT_OPTION_NAME = '--remote-debugging-port';\nexport const ADDRESS_OPTION_NAME = '--remote-debugging-address';\nexport const SUPPORTED_BROWSERS: readonly string[] = ['chromium'];\nexport const MAX_NETWORK_IDLE_THRESHOLD = 100;\nexport const MAX_NETWORK_IDLE_DURATION = 5000;\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"chalk\");","import chalk from 'chalk';\nimport { debuglog } from 'util';\n\nexport class Logger {\n  private static _instance: Logger;\n  private readonly _debug = debuglog('cypress-har-generator');\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  static get Instance(): Logger {\n    if (!this._instance) {\n      this._instance = new Logger();\n    }\n\n    return this._instance;\n  }\n\n  public info(msg: string): void {\n    this.log(chalk.blue(` ${msg}`));\n  }\n\n  public err(msg: string | Error | unknown): void {\n    this.log(chalk.red(` ${msg}`));\n  }\n\n  public warn(msg: string): void {\n    this.log(chalk.yellow(` ${msg}`));\n  }\n\n  public debug(msg: string): void {\n    this._debug(msg);\n  }\n\n  private log(msg: string): void {\n    // eslint-disable-next-line no-console\n    console.log(msg);\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"fs\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"crypto\");","import { Logger } from './Logger';\nimport { promisify } from 'util';\nimport {\n  access,\n  constants,\n  mkdir,\n  open,\n  unlink,\n  writeFile,\n  readFile,\n  WriteStream,\n  createWriteStream\n} from 'fs';\nimport { randomBytes } from 'crypto';\nimport { tmpdir } from 'os';\nimport { join } from 'path';\n\nexport class FileManager {\n  private static _instance: FileManager;\n\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  static get Instance(): FileManager {\n    if (!this._instance) {\n      this._instance = new FileManager();\n    }\n\n    return this._instance;\n  }\n\n  public async readFile(path: string): Promise<string | undefined> {\n    try {\n      return await promisify(readFile)(path, { encoding: 'utf-8' });\n    } catch (e) {\n      Logger.Instance.err(e);\n\n      return undefined;\n    }\n  }\n\n  public async writeFile(path: string, data: string): Promise<void> {\n    try {\n      await this.removeFile(path);\n      await promisify(writeFile)(path, data);\n    } catch (e) {\n      Logger.Instance.err(e);\n    }\n  }\n\n  public async createFolder(path: string): Promise<void> {\n    try {\n      if (await this.exists(path)) {\n        return;\n      }\n\n      await promisify(mkdir)(path);\n    } catch (e) {\n      Logger.Instance.err(e);\n    }\n  }\n\n  public async removeFile(path: string): Promise<void> {\n    try {\n      if (await this.exists(path)) {\n        await promisify(unlink)(path);\n      }\n    } catch (e) {\n      Logger.Instance.err(e);\n    }\n  }\n\n  public async exists(path: string): Promise<boolean> {\n    try {\n      await promisify(access)(path, constants.F_OK);\n\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  public async createTmpWriteStream(): Promise<WriteStream> {\n    const { fd, path } = await this.openTmpFd();\n\n    const stream = createWriteStream(path, {\n      fd,\n      flags: 'w',\n      mode: 0o666,\n      encoding: 'utf-8'\n    });\n\n    stream.path = path;\n\n    return stream;\n  }\n\n  private async openTmpFd(): Promise<{ path: string; fd: number }> {\n    const name = randomBytes(16).toString('hex').substring(16);\n    const path = join(tmpdir(), name);\n    const fd = await promisify(open)(path, 'w', 0o600);\n\n    return { path, fd };\n  }\n}\n","export const FAILED_ATTEMPT_TO_CONNECT =\n  'Failed to connect to Chrome Debugging Protocol';\nexport const ATTEMPT_TO_CONNECT =\n  'Attempting to connect to Chrome Debugging Protocol';\nexport const CONNECTED = 'Connected to Chrome Debugging Protocol';\nexport const DISCONNECTED = 'Chrome Debugging Protocol disconnected';\nexport const CONNECTION_NOT_ESTABLISHED = `Chrome Debugging Protocol connection has not been established.`;\nexport const TARGET_OR_BROWSER_CLOSED =\n  'The target or browser may have closed before completion of initialization';\nexport const UNABLE_TO_ATTACH_TO_TARGET = `Unable to attach to the target (e.g. page, worker, etc). \n\nPossible reasons for the failure include:\n  - Chrome not running in headless mode.\n  - The target may have closed during initialization.\n  - The target may have crashed due to memory issues.\n\nPlease open an issue on the repository: https://github.com/NeuraLegion/cypress-har-generator/issues for assistance.\n\nThe stack trace for this error is:`;\nexport const FAILED_TO_CONNECT = `${FAILED_ATTEMPT_TO_CONNECT}\n\nPossible reasons for failure:\n  - Chrome not running in headless mode\n  - Using Chrome version 58 or earlier\n  - Inconsistent RDP configuration settings.\n  \nThe stack trace for this error is:`;\n","import type { Network, NetworkEvent } from '../network';\nimport { ErrorUtils } from '../utils/ErrorUtils';\nimport type { Logger } from '../utils/Logger';\nimport {\n  TARGET_OR_BROWSER_CLOSED,\n  UNABLE_TO_ATTACH_TO_TARGET\n} from './messages';\nimport type { NetworkOptions } from './NetworkOptions';\nimport type { Client, EventMessage } from 'chrome-remote-interface';\nimport type Protocol from 'devtools-protocol';\n\nexport class DefaultNetwork implements Network {\n  private readonly DOMAIN = 'Network';\n  private readonly ALLOWED_TARGETS = new Set([\n    'service_worker',\n    'page',\n    'worker',\n    'background_page',\n    'webview',\n    'shared_worker'\n  ]);\n\n  private listener?: (event: NetworkEvent) => unknown;\n  private readonly sessions = new Map<string, string | undefined>();\n\n  constructor(\n    private readonly cdp: Client,\n    private readonly logger: Logger,\n    private readonly options?: NetworkOptions\n  ) {}\n\n  public async attachToTargets(\n    listener: (event: NetworkEvent) => unknown\n  ): Promise<void> {\n    this.listener = listener;\n\n    this.cdp.on('event', this.networkEventListener);\n    this.cdp.on('Target.attachedToTarget', this.attachedToTargetListener);\n    this.cdp.on('Network.requestWillBeSent', this.sessionListener);\n    this.cdp.on('Network.webSocketCreated', this.sessionListener);\n    await this.ignoreCertificateError();\n    await this.recursivelyAttachToTargets({ type: 'browser' });\n  }\n\n  public async detachFromTargets(): Promise<void> {\n    if (this.listener) {\n      this.cdp.off('event', this.networkEventListener);\n      this.cdp.off('Security.certificateError', this.certificateErrorListener);\n      this.cdp.off('Target.attachedToTarget', this.attachedToTargetListener);\n      this.cdp.off('Network.requestWillBeSent', this.sessionListener);\n      this.cdp.off('Network.webSocketCreated', this.sessionListener);\n      delete this.listener;\n    }\n\n    try {\n      await Promise.all([\n        this.cdp.send('Security.disable'),\n        this.enableAutoAttach(false)\n      ]);\n    } catch (e) {\n      // ADHOC: handle any unforeseen issues while detaching from targets.\n      this.logger.debug(`Unexpected error while detaching from targets: ${e}`);\n    }\n\n    this.sessions.clear();\n  }\n\n  public getRequestBody(\n    requestId: string\n  ): Promise<Protocol.Network.GetRequestPostDataResponse> {\n    return this.cdp.send(\n      'Network.getRequestPostData',\n      {\n        requestId\n      },\n      this.sessions.get(requestId)\n    );\n  }\n\n  public getResponseBody(\n    requestId: string\n  ): Promise<Protocol.Network.GetResponseBodyResponse> {\n    return this.cdp.send(\n      'Network.getResponseBody',\n      {\n        requestId\n      },\n      this.sessions.get(requestId)\n    );\n  }\n\n  private async ignoreCertificateError(): Promise<void> {\n    this.cdp.on('Security.certificateError', this.certificateErrorListener);\n    try {\n      await this.cdp.send('Security.enable');\n      await this.cdp.send('Security.setOverrideCertificateErrors', {\n        override: true\n      });\n    } catch (e) {\n      // ADHOC: The CDP protocol may not support the Security domain.\n      this.logger.debug(\n        ErrorUtils.isError(e) ? e.message : `Something went wrong: ${e}`\n      );\n    }\n  }\n\n  private networkEventListener = (eventMessage: EventMessage) => {\n    if (this.matchNetworkEvents(eventMessage)) {\n      setImmediate(() => this.listener?.(eventMessage));\n    }\n  };\n\n  private certificateErrorListener = ({\n    eventId\n  }: Protocol.Security.CertificateErrorEvent) =>\n    this.cdp.send('Security.handleCertificateError', {\n      eventId,\n      action: 'continue'\n    });\n\n  private matchNetworkEvents(\n    message: Pick<EventMessage, 'method'>\n  ): message is NetworkEvent {\n    const [domain]: string[] = message.method.split('.');\n\n    return domain === this.DOMAIN;\n  }\n\n  private async recursivelyAttachToTargets(options: {\n    sessionId?: string;\n    type: string;\n  }): Promise<void> {\n    await this.enableAutoAttach(true, options.sessionId);\n\n    if (this.ALLOWED_TARGETS.has(options.type)) {\n      await this.trackNetworkEvents(options.sessionId);\n    }\n  }\n\n  private enableAutoAttach(\n    autoAttach: boolean,\n    sessionId?: string\n  ): Promise<void> {\n    return this.cdp.send(\n      'Target.setAutoAttach',\n      {\n        autoAttach,\n        flatten: true,\n        waitForDebuggerOnStart: true\n      },\n      sessionId\n    );\n  }\n\n  private sessionListener = (\n    {\n      requestId\n    }:\n      | Protocol.Network.RequestWillBeSentEvent\n      | Protocol.Network.WebSocketCreatedEvent,\n    sessionId?: string\n  ) => {\n    this.sessions.set(requestId, sessionId);\n    this.logger.debug(\n      `Session ${sessionId ?? 'N/A'} associated with request: ${requestId}`\n    );\n  };\n\n  private attachedToTargetListener = async ({\n    sessionId,\n    targetInfo,\n    waitingForDebugger\n  }: Protocol.Target.AttachedToTargetEvent): Promise<void> => {\n    try {\n      await this.recursivelyAttachToTargets({\n        sessionId,\n        type: targetInfo.type\n      });\n\n      if (waitingForDebugger) {\n        await this.cdp.send(\n          'Runtime.runIfWaitingForDebugger',\n          undefined,\n          sessionId\n        );\n      }\n    } catch (e) {\n      const stack = ErrorUtils.isError(e) ? e.stack : e;\n\n      this.logger.debug(\n        `We encountered an issue while initializing the target for the session: ${sessionId}.`\n      );\n      this.logger.debug(\n        `The information about the target is as follows: ${JSON.stringify(\n          targetInfo\n        )}`\n      );\n      this.logger.warn(`${UNABLE_TO_ATTACH_TO_TARGET}\\n${stack}`);\n    }\n  };\n\n  private async trackNetworkEvents(sessionId?: string): Promise<void> {\n    try {\n      await Promise.all([\n        this.cdp.send('Network.enable', this.options ?? {}, sessionId),\n        this.cdp.send(\n          'Network.setCacheDisabled',\n          {\n            cacheDisabled: true\n          },\n          sessionId\n        )\n      ]);\n    } catch (e) {\n      if (this.targetClosedError(e)) {\n        this.logger.debug(TARGET_OR_BROWSER_CLOSED);\n\n        return;\n      }\n\n      throw e;\n    }\n  }\n\n  private targetClosedError(e: unknown): e is Error {\n    return (\n      ErrorUtils.isError(e) &&\n      (e.message.includes('Target closed') ||\n        e.message.includes('Session closed'))\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"chrome-remote-interface\");","import { RetryStrategy } from './RetryStrategy';\nimport { Logger } from '../utils/Logger';\nimport {\n  ATTEMPT_TO_CONNECT,\n  CONNECTED,\n  CONNECTION_NOT_ESTABLISHED,\n  DISCONNECTED,\n  FAILED_ATTEMPT_TO_CONNECT,\n  FAILED_TO_CONNECT\n} from './messages';\nimport type { Connection } from './Connection';\nimport type { Network } from '../network';\nimport { DefaultNetwork } from './DefaultNetwork';\nimport { ErrorUtils } from '../utils/ErrorUtils';\nimport type { NetworkOptions } from './NetworkOptions';\nimport CDP, { Version } from 'chrome-remote-interface';\nimport type { Client, Options } from 'chrome-remote-interface';\n\nexport class CDPConnection implements Connection {\n  private _network?: Network;\n  private _cdp?: Client;\n\n  get cdp() {\n    return this._cdp;\n  }\n\n  constructor(\n    private readonly options: Options,\n    private readonly logger: Logger,\n    private readonly retryStrategy: RetryStrategy\n  ) {}\n\n  public async open(): Promise<void> {\n    try {\n      this.logger.debug(ATTEMPT_TO_CONNECT);\n\n      const target = await this.populateBrowserTarget();\n\n      const cdp = await CDP({\n        target\n      });\n\n      this.logger.debug(CONNECTED);\n\n      cdp.once('disconnect', (): void => this.logger.debug(DISCONNECTED));\n\n      this._cdp = cdp;\n    } catch (e) {\n      const message = ErrorUtils.isError(e) ? e.message : e;\n      this.logger.debug(`${FAILED_ATTEMPT_TO_CONNECT}: ${message}`);\n\n      if (\n        !(await this.retryStrategy.execute((): Promise<void> => this.open()))\n      ) {\n        throw new Error(FAILED_TO_CONNECT);\n      }\n    }\n  }\n\n  public async close(): Promise<void> {\n    if (this._cdp) {\n      await this._cdp.close();\n      this._cdp.removeAllListeners();\n      delete this._cdp;\n      this.logger.debug(DISCONNECTED);\n    }\n  }\n\n  public discoverNetwork(options?: NetworkOptions): Network {\n    if (!this.cdp) {\n      throw new Error(CONNECTION_NOT_ESTABLISHED);\n    }\n\n    if (!this._network) {\n      this._network = new DefaultNetwork(this.cdp, this.logger, options);\n    }\n\n    return this._network;\n  }\n\n  private async populateBrowserTarget(): Promise<string> {\n    const { port, host } = this.options;\n    const { webSocketDebuggerUrl } = await Version({\n      host,\n      port\n    });\n\n    return webSocketDebuggerUrl ?? `ws://${host}:${port}/devtools/browser`;\n  }\n}\n","import Timeout = NodeJS.Timeout;\n\nexport class RetryStrategy {\n  private _times: number;\n  private backoffTime: number;\n  private readonly maximumBackoff: number;\n  private readonly maxRetries: number;\n\n  constructor(\n    maxRetries: number = 3,\n    initialBackoff: number = 5,\n    maximumBackoff: number = 25\n  ) {\n    this._times = 0;\n    this.maxRetries = maxRetries;\n    this.backoffTime = initialBackoff;\n    this.maximumBackoff = maximumBackoff;\n  }\n\n  public async execute<T extends (...args: any[]) => unknown>(\n    task: T\n  ): Promise<number> {\n    const timeout: number | undefined = this.nextTime();\n\n    if (timeout) {\n      await this.delay(timeout);\n\n      await task();\n    }\n\n    return this.maxRetries - this._times;\n  }\n\n  private delay(timeout: number): Promise<void> {\n    return new Promise<void>(\n      (resolve): Timeout => setTimeout(resolve, timeout)\n    );\n  }\n\n  private nextTime(): number | undefined {\n    if (this._times < this.maxRetries) {\n      return this.increaseBackoffTime();\n    }\n\n    return undefined;\n  }\n\n  private increaseBackoffTime(): number {\n    this.backoffTime *= Math.pow(2, ++this._times - 1);\n\n    return Math.min(this.backoffTime, this.maximumBackoff);\n  }\n}\n","import { Plugin } from './Plugin';\nimport { Logger } from './utils/Logger';\nimport { FileManager } from './utils/FileManager';\nimport { DefaultConnectionFactory } from './cdp';\nimport { DefaultHarExporterFactory, DefaultObserverFactory } from './network';\nimport { StringUtils } from './utils/StringUtils';\nimport type { RecordOptions, SaveOptions } from './Plugin';\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/no-namespace\n  namespace Cypress {\n    interface Chainable<Subject> {\n      saveHar(options?: Partial<SaveOptions>): Chainable<Subject>;\n      recordHar(options?: Partial<RecordOptions>): Chainable<Subject>;\n      disposeOfHar(): Chainable<Subject>;\n    }\n  }\n}\n\nconst plugin = new Plugin(\n  Logger.Instance,\n  FileManager.Instance,\n  new DefaultConnectionFactory(Logger.Instance),\n  new DefaultObserverFactory(Logger.Instance),\n  new DefaultHarExporterFactory(FileManager.Instance, Logger.Instance)\n);\n\nexport const install = (on: Cypress.PluginEvents): void => {\n  // ADHOC: Cypress expect the return value to be null to signal that the given event has been handled properly.\n  // https://docs.cypress.io/api/commands/task#Usage\n  on('task', {\n    saveHar: async (options: SaveOptions): Promise<null> => {\n      await plugin.saveHar(options);\n\n      return null;\n    },\n    recordHar: async (options: RecordOptions): Promise<null> => {\n      await plugin.recordHar(options);\n\n      return null;\n    },\n    disposeOfHar: async (): Promise<null> => {\n      await plugin.disposeOfHar();\n\n      return null;\n    }\n  });\n\n  on(\n    'before:browser:launch',\n    (\n      browser: Cypress.Browser | null,\n      launchOptions: Cypress.BeforeBrowserLaunchOptions\n    ) => {\n      ensureBrowserFlags((browser ?? {}) as Cypress.Browser, launchOptions);\n\n      return launchOptions;\n    }\n  );\n};\n\nexport const enableExperimentalLifecycle = (\n  on: Cypress.PluginEvents,\n  config: Cypress.PluginConfigOptions\n) => {\n  // FIXME: `isInteractive` is always true. For details see https://github.com/cypress-io/cypress/issues/20789\n  if (!config.isTextTerminal && !config.experimentalInteractiveRunEvents) {\n    Logger.Instance.warn(\n      'To activate the experimental mechanism for setting up lifecycle, you must either disable the interactive mode or activate the \"experimentalInteractiveRunEvents\" feature. For further information, please refer to: https://docs.cypress.io/guides/references/experiments#Configuration'\n    );\n  } else {\n    on('before:spec', (_: Cypress.Spec) =>\n      plugin.recordHar({\n        content: true,\n        includeBlobs: true,\n        rootDir: StringUtils.dirname(Cypress.spec.absolute)\n      })\n    );\n    on('after:spec', (spec: Cypress.Spec, _: CypressCommandLine.RunResult) =>\n      plugin.saveHar({\n        fileName: StringUtils.normalizeName(spec.name, { ext: '.har' }),\n        outDir: config.env.hars_folders ?? '.'\n      })\n    );\n  }\n};\n\n/**\n * Function has been deprecated. Use {@link install} instead as follows:\n * ```diff\n * setupNodeEvents(on) {\n *   install(on);\n * -  // bind to the event we care about\n * -  on('before:browser:launch', (browser = {}, launchOptions) => {\n * -    ensureBrowserFlags(browser, launchOptions);\n * -    return launchOptions;\n * -  });\n * }\n * ```\n * In case of any issues please refer to {@link https://github.com/cypress-io/cypress/issues/5240}\n */\nexport const ensureBrowserFlags = (\n  browser: Cypress.Browser,\n  launchOptions: Cypress.BeforeBrowserLaunchOptions\n): void => {\n  launchOptions.args.push(\n    ...plugin.ensureBrowserFlags(browser, launchOptions.args)\n  );\n};\n\nexport type { SaveOptions, RecordOptions } from './Plugin';\n","import { Logger } from './utils/Logger';\nimport { FileManager } from './utils/FileManager';\nimport type {\n  HarExporter,\n  HarExporterFactory,\n  HarExporterOptions,\n  NetworkObserverOptions,\n  Observer,\n  ObserverFactory\n} from './network';\nimport { HarBuilder, NetworkIdleMonitor, NetworkRequest } from './network';\nimport { ErrorUtils } from './utils/ErrorUtils';\nimport type { Connection, ConnectionFactory, NetworkOptions } from './cdp';\nimport {\n  ADDRESS_OPTION_NAME,\n  MAX_NETWORK_IDLE_THRESHOLD,\n  MAX_NETWORK_IDLE_DURATION,\n  PORT_OPTION_NAME,\n  SUPPORTED_BROWSERS\n} from './constants';\nimport { join } from 'path';\nimport { EOL } from 'os';\nimport { promisify } from 'util';\n\nexport interface SaveOptions {\n  fileName: string;\n  outDir: string;\n  waitForIdle?: boolean;\n  minIdleDuration?: number;\n  maxWaitDuration?: number;\n}\n\nexport type RecordOptions = NetworkObserverOptions &\n  HarExporterOptions &\n  NetworkOptions;\n\ninterface Addr {\n  port: number;\n  host: string;\n}\n\nexport class Plugin {\n  private exporter?: HarExporter;\n  private networkObservable?: Observer<NetworkRequest>;\n  private addr?: Addr;\n  private _connection?: Connection;\n  private supported?: boolean;\n\n  constructor(\n    private readonly logger: Logger,\n    private readonly fileManager: FileManager,\n    private readonly connectionFactory: ConnectionFactory,\n    private readonly observerFactory: ObserverFactory,\n    private readonly exporterFactory: HarExporterFactory\n  ) {}\n\n  public ensureBrowserFlags(\n    browser: Cypress.Browser,\n    args: string[]\n  ): string[] {\n    this.supported = this.isSupportedBrowser(browser);\n    if (!this.supported) {\n      this.logger.warn(\n        `HAR recording is not supported in this browser: ${browser.name}`\n      );\n    }\n\n    const electronUsed = browser.name === 'electron';\n\n    if (electronUsed) {\n      args = this.parseElectronSwitches(browser);\n    }\n\n    const browserFlags: string[] = this.ensureRdpAddrArgs(args);\n\n    return electronUsed\n      ? []\n      : browserFlags.filter((x: string): boolean => !args.includes(x));\n  }\n\n  public async recordHar(options: RecordOptions): Promise<void> {\n    if (!this.addr) {\n      throw new Error(\n        `Please call the 'ensureBrowserFlags' before attempting to start the recording.`\n      );\n    }\n\n    if (!this.supported) {\n      return;\n    }\n\n    await this.closeConnection();\n\n    this.exporter = await this.exporterFactory.create(options);\n    this._connection = this.connectionFactory.create({\n      ...this.addr,\n      maxRetries: 20,\n      maximumBackoff: 100,\n      initialBackoff: 5\n    });\n\n    await this._connection.open();\n\n    await this.listenNetworkEvents(options);\n  }\n\n  public async saveHar(options: SaveOptions): Promise<void> {\n    if (!this.supported) {\n      return;\n    }\n\n    const filePath = join(options.outDir, options.fileName);\n\n    if (!this._connection) {\n      this.logger.err(`Failed to save HAR. First you should start recording.`);\n\n      return;\n    }\n\n    try {\n      await this.fileManager.createFolder(options.outDir);\n\n      if (options.waitForIdle) {\n        await this.waitForNetworkIdle(options);\n      }\n\n      const har: string | undefined = await this.buildHar();\n\n      if (har) {\n        await this.fileManager.writeFile(filePath, har);\n      }\n    } catch (e) {\n      const message = ErrorUtils.isError(e) ? e.message : e;\n      this.logger.err(\n        `An error occurred while attempting to save the HAR file. Error details: ${message}`\n      );\n    } finally {\n      await this.disposeOfHar();\n    }\n  }\n\n  public async disposeOfHar(): Promise<void> {\n    if (!this.supported) {\n      return;\n    }\n\n    await this.networkObservable?.unsubscribe();\n    delete this.networkObservable;\n\n    if (this.exporter) {\n      this.exporter.end();\n      await this.fileManager.removeFile(this.exporter.path);\n      delete this.exporter;\n    }\n  }\n\n  private parseElectronSwitches(browser: Cypress.Browser): string[] {\n    if (!process.env.ELECTRON_EXTRA_LAUNCH_ARGS?.includes(PORT_OPTION_NAME)) {\n      this.logger\n        .err(`The '${browser.name}' browser was detected, however, the required '${PORT_OPTION_NAME}' command line switch was not provided. \nThis switch is necessary to enable remote debugging over HTTP on the specified port. \n\nPlease refer to the documentation:\n  - https://www.electronjs.org/docs/latest/api/command-line-switches#--remote-debugging-portport\n  - https://docs.cypress.io/api/plugins/browser-launch-api#Modify-Electron-app-switches`);\n      throw new Error(\n        `Missing '${PORT_OPTION_NAME}' command line switch for Electron browser`\n      );\n    }\n\n    return process.env.ELECTRON_EXTRA_LAUNCH_ARGS.split(' ');\n  }\n\n  private async buildHar(): Promise<string | undefined> {\n    if (this.exporter) {\n      const content = await this.fileManager.readFile(this.exporter.path);\n\n      if (content) {\n        const entries = content\n          .split(EOL)\n          .filter(Boolean)\n          .map(x => JSON.parse(x));\n\n        const har = new HarBuilder(entries).build();\n\n        return JSON.stringify(har, null, 2);\n      }\n    }\n\n    return undefined;\n  }\n\n  private async waitForNetworkIdle(\n    options: Pick<SaveOptions, 'minIdleDuration' | 'maxWaitDuration'>\n  ): Promise<void> {\n    const {\n      minIdleDuration = MAX_NETWORK_IDLE_THRESHOLD,\n      maxWaitDuration = MAX_NETWORK_IDLE_DURATION\n    } = options;\n    const cancellation = promisify(setTimeout)(maxWaitDuration);\n\n    return Promise.race([\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      new NetworkIdleMonitor(this.networkObservable!).waitForIdle(\n        minIdleDuration\n      ),\n      cancellation\n    ]);\n  }\n\n  private async listenNetworkEvents(options: RecordOptions): Promise<void> {\n    const network = this._connection?.discoverNetwork(options);\n\n    this.networkObservable = this.observerFactory.createNetworkObserver(\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      network!,\n      options\n    );\n\n    return this.networkObservable.subscribe((request: NetworkRequest) =>\n      this.exporter?.write(request)\n    );\n  }\n\n  private async closeConnection(): Promise<void> {\n    if (this._connection) {\n      await this._connection.close();\n      delete this._connection;\n    }\n  }\n\n  private isSupportedBrowser(browser: Cypress.Browser): boolean {\n    return SUPPORTED_BROWSERS.includes(browser?.family);\n  }\n\n  private ensureRdpAddrArgs(args: string[]): string[] {\n    const {\n      host = 'localhost',\n      port = 40000 + Math.round(Math.random() * 25000)\n    } = this.extractAddrFromArgs(args);\n\n    this.addr = { host, port };\n\n    return [\n      ...args,\n      `${PORT_OPTION_NAME}=${port}`,\n      `${ADDRESS_OPTION_NAME}=${host}`\n    ];\n  }\n\n  private extractAddrFromArgs(args: string[]): Partial<Addr> {\n    const port: string | undefined = this.findAndParseIfPossible(\n      args,\n      PORT_OPTION_NAME\n    );\n    const host: string | undefined = this.findAndParseIfPossible(\n      args,\n      ADDRESS_OPTION_NAME\n    );\n\n    let addr: { port?: number; host?: string } = {};\n\n    if (port && !isNaN(+port)) {\n      addr = { port: +port };\n    }\n\n    if (host) {\n      addr = { ...addr, host };\n    }\n\n    return addr;\n  }\n\n  private findAndParseIfPossible(\n    args: string[],\n    optionName: string\n  ): string | undefined {\n    const arg: string | undefined = args.find((x: string): boolean =>\n      x.startsWith(optionName)\n    );\n    const [, value]: string[] = arg?.split('=', 2) ?? [];\n\n    return value;\n  }\n}\n","import type { ConnectionFactory, ConnectionOptions } from './ConnectionFactory';\nimport { RetryStrategy } from './RetryStrategy';\nimport type { Connection } from './Connection';\nimport { CDPConnection } from './CDPConnection';\nimport { Logger } from '../utils/Logger';\n\nexport class DefaultConnectionFactory implements ConnectionFactory {\n  constructor(private readonly logger: Logger) {}\n\n  public create({\n    maxRetries,\n    initialBackoff,\n    maximumBackoff,\n    ...options\n  }: ConnectionOptions): Connection {\n    const retryStrategy = new RetryStrategy(\n      maxRetries,\n      initialBackoff,\n      maximumBackoff\n    );\n\n    return new CDPConnection(options, this.logger, retryStrategy);\n  }\n}\n","import { NetworkObserver } from './NetworkObserver';\nimport { Logger } from '../utils/Logger';\nimport { NetworkRequest } from './NetworkRequest';\nimport { CompositeFilter } from './filters';\nimport type { ObserverFactory } from './ObserverFactory';\nimport type { NetworkObserverOptions } from './NetworkObserverOptions';\nimport type { Observer } from './Observer';\nimport type { Network } from './Network';\n\nexport class DefaultObserverFactory implements ObserverFactory {\n  private readonly defaultRequestFilter = new CompositeFilter();\n\n  constructor(private readonly logger: Logger) {}\n\n  public createNetworkObserver(\n    network: Network,\n    options: NetworkObserverOptions\n  ): Observer<NetworkRequest> {\n    return new NetworkObserver(\n      options,\n      network,\n      this.logger,\n      this.defaultRequestFilter\n    );\n  }\n}\n","import type {\n  HarExporterFactory,\n  HarExporterOptions\n} from './HarExporterFactory';\nimport type { HarExporter } from './HarExporter';\nimport { DefaultHarExporter } from './DefaultHarExporter';\nimport { Loader } from '../utils/Loader';\nimport type { FileManager } from '../utils/FileManager';\nimport type { Logger } from '../utils/Logger';\nimport type {\n  DefaultHarExporterOptions,\n  Filter,\n  Transformer\n} from './DefaultHarExporterOptions';\nimport { resolve } from 'path';\n\nexport class DefaultHarExporterFactory implements HarExporterFactory {\n  constructor(\n    private readonly fileManager: FileManager,\n    private readonly logger: Logger\n  ) {}\n\n  public async create(options: HarExporterOptions): Promise<HarExporter> {\n    const settings = await this.createSettings(options);\n    const stream = await this.fileManager.createTmpWriteStream();\n\n    return new DefaultHarExporter(this.logger, stream, settings);\n  }\n\n  private async createSettings({\n    filter,\n    transform,\n    rootDir\n  }: HarExporterOptions) {\n    const [preProcessor, postProcessor]: (Filter | Transformer | undefined)[] =\n      await Promise.all(\n        [filter, transform].map(path => this.loadCustomProcessor(path, rootDir))\n      );\n\n    return {\n      filter: preProcessor,\n      transform: postProcessor\n    } as DefaultHarExporterOptions;\n  }\n\n  private async loadCustomProcessor<T extends Filter | Transformer>(\n    path: string | undefined,\n    rootDir: string\n  ): Promise<T | undefined> {\n    let processor: T | undefined;\n\n    if (path) {\n      const absolutePath = resolve(rootDir, path);\n      processor = await Loader.load(absolutePath);\n    }\n\n    return processor;\n  }\n}\n"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","require","EntryBuilder","constructor","request","build","serverIPAddress","this","remoteAddress","portPositionInString","lastIndexOf","substr","timings","buildTimings","time","values","reduce","acc","t","Math","max","entry","startedDateTime","Date","getWallTime","issueTime","toJSON","buildRequest","response","buildResponse","cache","replace","_priority","priority","_resourceType","resourceType","_webSocketMessages","frames","_eventSourceMessages","eventSourceMessages","connectionId","connection","getResponseBodySize","statusCode","responseHeadersText","transferSize","length","getResponseCompression","resourceSize","toMilliseconds","res","method","requestMethod","url","buildRequestURL","httpVersion","requestHttpVersion","headers","requestHeaders","queryString","queryParameters","cookies","buildCookies","requestCookies","headersSize","requestHeadersText","bodySize","requestBodySize","postData","buildPostData","status","statusText","responseHttpVersion","responseHeaders","responseCookies","content","buildContent","redirectURL","responseHeaderValue","_transferSize","data","contentData","assign","size","mimeType","compression","timing","startTime","result","blocked","dns","ssl","connect","send","wait","receive","queuedTime","highestTime","blockedStart","leastNonNegative","dnsStart","connectStart","sendStart","Infinity","dnsEnd","sslStart","sslEnd","connectEnd","sendEnd","responseReceivedTime","endTime","requestTime","waitStart","waitEnd","receiveStart","receiveEnd","find","item","requestFormData","requestContentType","text","formParameters","params","split","map","buildCookie","bind","cookie","name","path","domain","expires","expiresDate","httpOnly","secure","contentLength","ErrorUtils","isError","val","Error","DefaultHarExporter","logger","buffer","options","Buffer","isBuffer","toString","filter","transform","write","networkRequest","applyFilter","json","serializeEntry","closed","promisify","EOL","JSON","stringify","e","stack","debug","format","err","end","message","Loader","load","shouldUseDynamicImport","import","default","interopRequireDefault","includes","m","CookieAttribute","WebSocketFrameType","NetworkCookie","_attributes","Map","_size","_name","_value","has","HTTPONLY","SECURE","sameSite","SAMESITE","session","EXPIRES","MAXAGE","PATH","port","PORT","DOMAIN","maxAge","isNaN","requestDate","targetDate","getTime","addAttribute","set","toLowerCase","CookieParser","_lastCookiePosition","parseCookie","cookieHeader","_initialize","kv","_extractKeyValue","charAt","_lastCookie","slice","addCookie","advanceAndCheckCookieDelimiter","flushCookie","_cookies","parseSetCookie","setCookieHeader","headerValue","_input","_originalInputLength","keyValueMatch","exec","toCamelCase","trim","position","str","toUpperCase","match","keyValue","push","StringUtils","isString","toRegexSource","pattern","source","toRegex","RegExp","dirname","normalizedPath","removeTrailingSlash","fileNameIdx","substring","normalizeName","removeLeadingSlash","extIdx","ext","nameWithoutExt","escapeCharacters","chars","foundChar","i","indexOf","j","NetworkRequest","_requestId","documentURL","loaderId","initiator","frameId","_wallIssueTime","_requestHeaderValues","_responseHeaderValues","_requestFormData","Promise","resolve","_hasExtraResponseInfo","_hasExtraRequestInfo","_connectionId","_protocol","_requestTime","_requestMethod","_statusText","_remoteAddress","_startTime","_issueTime","_endTime","_responseReceivedTime","_resourceSize","_requestHeaders","_requestHeadersText","_connectionReused","_responseHeaders","_responseHeadersText","_frames","_statusCode","signedExchangeInfo","_signedExchangeInfo","info","hasExtraResponseInfo","hasExtraRequestInfo","protocol","parsedURL","_parsedURL","_url","URL","_queryString","_parsedQueryParameters","x","_timing","timingInfo","headersReceivedTime","receiveHeadersEnd","_mimeType","redirectSource","_redirectSource","originatingRequest","clear","_requestCookies","requestHeaderValue","parseInt","connectionReused","_responseCookies","questionMarkPosition","hashSignPosition","initialPriority","_initialPriority","requestId","getFilteredProtocolName","parseParameters","_currentPriority","waitForCompletion","all","_contentData","_formParametersPromise","isBlob","startsWith","setRemoteAddress","ip","setIssueTime","monotonicTime","wallTime","increaseTransferSize","setRequestFormData","parseFormParameters","setContentData","then","body","base64Encoded","encoding","catch","error","addProtocolFrameError","errorMessage","addFrame","type","ERROR","opcode","mask","addProtocolFrame","sent","REQUEST","RESPONSE","payloadData","addEventSourceMessage","eventName","eventId","markAsRedirect","redirectCount","addExtraRequestInfo","extraRequestInfo","addExtraResponseInfo","extraResponseInfo","pathname","search","headerName","computeHeaderValue","formUrlencoded","multipartDetails","boundary","formData","parseMultipartFormDataParameters","sanitizedBoundary","keyValuePattern","field","fileName","contentType","frame","pair","join","ExtraInfoBuilder","deleteCallback","_hasExtraInfo","_finished","_requests","_requestExtraInfo","_responseExtraInfo","addRequest","sync","addRequestExtraInfo","addResponseExtraInfo","finished","deleteIfComplete","lastRequest","getLastRequest","getRequestIndex","req","index","requestExtraInfo","responseExtraInfo","NetworkObserver","network","requestFilter","_entries","_extraInfoBuilders","empty","subscribe","callback","destination","attachToTargets","event","handleEvent","unsubscribe","detachFromTargets","signedExchangeReceived","updateNetworkRequestWithResponse","outerResponse","requestWillBeSent","redirectResponse","timestamp","responseReceived","_appendRedirect","createRequest","updateNetworkRequestWithRequest","getExtraInfoBuilder","startRequest","dataReceived","dataLength","encodedDataLength","resourceChangedPriority","newPriority","loadingFinished","finishRequest","loadingFailed","errorText","canceled","webSocketCreated","eventSourceMessageReceived","webSocketWillSendHandshakeRequest","headersMapToHeadersArray","webSocketHandshakeResponseReceived","headersText","webSocketFrameSent","webSocketFrameReceived","webSocketFrameError","webSocketClosed","requestWillBeSentExtraInfo","responseReceivedExtraInfo","delete","originalNetworkRequest","redirect","newNetworkRequest","finishTime","loadContent","shouldExcludeRequest","finally","getResponseBody","chromeRequest","hasPostData","getRequestPostData","rawRequest","getRequestBody","String","remoteIPAddress","remotePort","headersMap","keys","wouldApply","apply","sessionId","methodName","HostFilter","includeHosts","host","some","test","Array","isArray","PathFilter","excludePaths","MimeFilter","includeMimes","MinStatusCodeFilter","minStatusCodeToInclude","threshold","normalizeThreshold","round","abs","BlobFilter","_","includeBlobs","StatusCodeFilter","excludeStatusCodes","CompositeFilter","children","every","HarBuilder","entries","version","homepage","comment","log","pages","creator","NetworkIdleMonitor","networkObservable","waitForIdle","idleTime","startIdleTime","startIdleTimer","shouldResolve","setTimeout","now","PORT_OPTION_NAME","ADDRESS_OPTION_NAME","SUPPORTED_BROWSERS","MAX_NETWORK_IDLE_THRESHOLD","MAX_NETWORK_IDLE_DURATION","Logger","_debug","debuglog","Instance","_instance","msg","warn","console","FileManager","readFile","writeFile","removeFile","createFolder","exists","mkdir","unlink","access","constants","F_OK","createTmpWriteStream","fd","openTmpFd","stream","createWriteStream","flags","mode","randomBytes","tmpdir","open","FAILED_ATTEMPT_TO_CONNECT","DISCONNECTED","FAILED_TO_CONNECT","DefaultNetwork","cdp","ALLOWED_TARGETS","Set","sessions","networkEventListener","eventMessage","matchNetworkEvents","setImmediate","listener","certificateErrorListener","action","sessionListener","attachedToTargetListener","targetInfo","waitingForDebugger","recursivelyAttachToTargets","on","ignoreCertificateError","off","enableAutoAttach","override","trackNetworkEvents","autoAttach","flatten","waitForDebuggerOnStart","cacheDisabled","targetClosedError","CDPConnection","retryStrategy","_cdp","target","populateBrowserTarget","once","execute","close","removeAllListeners","discoverNetwork","_network","webSocketDebuggerUrl","Version","RetryStrategy","maxRetries","initialBackoff","maximumBackoff","_times","backoffTime","task","timeout","nextTime","delay","increaseBackoffTime","pow","min","fileManager","connectionFactory","observerFactory","exporterFactory","ensureBrowserFlags","browser","args","supported","isSupportedBrowser","electronUsed","parseElectronSwitches","browserFlags","ensureRdpAddrArgs","recordHar","addr","closeConnection","exporter","create","_connection","listenNetworkEvents","saveHar","filePath","outDir","waitForNetworkIdle","har","buildHar","disposeOfHar","process","env","ELECTRON_EXTRA_LAUNCH_ARGS","Boolean","parse","minIdleDuration","maxWaitDuration","cancellation","race","createNetworkObserver","family","random","extractAddrFromArgs","findAndParseIfPossible","optionName","arg","defaultRequestFilter","settings","createSettings","rootDir","preProcessor","postProcessor","loadCustomProcessor","processor","absolutePath","install","launchOptions","enableExperimentalLifecycle","config","isTextTerminal","experimentalInteractiveRunEvents","Cypress","spec","absolute","hars_folders"],"sourceRoot":""}